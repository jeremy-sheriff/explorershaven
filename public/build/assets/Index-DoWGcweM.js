import{f as De,X as I,_ as Be}from"./AppLayout.vue_vue_type_script_setup_true_lang-C3dP_MzM.js";import{d as Ue}from"./index-C4J_hXM0.js";import{d as Ee,f as q,g as Z,i as h,p as re,c as m,a as s,u as e,h as Te,w as n,b as d,t as o,j as _,k as i,o as u,l as j,F as N,r as K,e as P,m as ee}from"./app-CQbF_N0A.js";import{_ as V}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-49AckZgE.js";import{_ as oe,a as ie,b as ue,c as me,d as fe}from"./DialogTitle.vue_vue_type_script_setup_true_lang-1N8TprrL.js";import{_ as pe,a as _e}from"./DialogFooter.vue_vue_type_script_setup_true_lang-D-k4l9Ry.js";import{_ as $,a as D,b as B,c as U,d as x}from"./SelectValue.vue_vue_type_script_setup_true_lang-CmCWCKXP.js";import{_ as E}from"./Input.vue_vue_type_script_setup_true_lang-C0rsbXPy.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-CebJICUO.js";import{F as Ie}from"./filter-CFmILEeJ.js";import"./index-_AReeDHv.js";import"./VisuallyHidden-B3Q8tllW.js";import"./useForwardExpose-Z8ulzWTB.js";import"./useForwardPropsEmits-C6Fer4sO.js";import"./createLucideIcon-BqlCTDOI.js";import"./check-DGR_uu83.js";import"./useFormControl-DtkPTX0I.js";const je={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},Ne={class:"grid auto-rows-min gap-4 md:grid-cols-4"},Le={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},Ge={class:"text-2xl font-bold"},Ke={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},Oe={class:"text-2xl font-bold"},ze={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},Re={class:"text-2xl font-bold"},He={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},Me={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Xe={class:"relative min-h-[100vh] flex-1 rounded-xl border border-sidebar-border/70 bg-white md:min-h-min dark:border-sidebar-border dark:bg-sidebar"},qe={class:"p-6"},Je={class:"mb-4 flex items-center justify-between"},Qe={class:"flex gap-2"},We={key:0,class:"ml-1 rounded-full bg-primary px-2 py-0.5 text-xs text-primary-foreground"},Ye={key:0,class:"mb-6 rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-sidebar-accent"},Ze={class:"mb-4 flex items-center justify-between"},et={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},tt={class:"grid gap-2"},at={class:"grid gap-2"},st={class:"grid gap-2"},dt={class:"grid gap-2"},lt={class:"grid gap-2"},nt={class:"grid gap-2"},rt={class:"grid gap-2"},ot={class:"grid gap-2"},it={class:"mt-4 flex justify-end gap-2"},ut={key:1,class:"mb-4 flex flex-wrap gap-2"},mt={key:0,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},ft={key:1,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},pt={key:2,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},_t={key:3,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},gt={key:4,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},xt={key:5,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},bt={class:"overflow-x-auto"},vt={class:"min-w-full divide-y divide-gray-200"},ct={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-sidebar"},yt={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},kt={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},wt={class:"whitespace-nowrap px-6 py-4 text-sm"},St={class:"whitespace-nowrap px-6 py-4 text-sm"},Vt={class:"whitespace-nowrap px-6 py-4 text-sm font-semibold"},Ct={class:"whitespace-nowrap px-6 py-4 text-sm"},ht={key:0,class:"font-semibold text-orange-600 dark:text-orange-400"},Ft={key:1,class:"font-semibold text-green-600 dark:text-green-400"},At={class:"whitespace-nowrap px-6 py-4 text-sm"},Pt={class:"whitespace-nowrap px-6 py-4 text-sm"},$t={class:"whitespace-nowrap px-6 py-4 text-right"},Dt={class:"flex items-center justify-end gap-2"},Bt={key:0,class:"py-12 text-center"},Ut={class:"grid gap-4 py-4"},Et={class:"grid gap-2"},Tt={key:0,class:"text-sm text-red-600"},It={key:1,class:"rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},jt={class:"text-sm font-medium text-blue-800 dark:text-blue-200"},Nt={key:2,class:"rounded-lg bg-red-50 p-3 dark:bg-red-900/20"},Lt={class:"text-sm font-medium text-red-800 dark:text-red-200"},Gt={key:3,class:"rounded-lg bg-green-50 p-3 dark:bg-green-900/20"},Kt={class:"text-sm font-medium text-green-800 dark:text-green-200"},Ot={class:"grid gap-2"},zt={key:0,class:"text-xs text-muted-foreground"},Rt={key:1,class:"text-sm text-red-600"},Ht={class:"grid gap-4 sm:grid-cols-2"},Mt={class:"grid gap-2"},Xt={key:0,class:"text-sm text-red-600"},qt={class:"grid gap-2"},Jt={key:0,class:"text-sm text-red-600"},Qt={class:"grid gap-4 py-4"},Wt={class:"grid gap-2"},Yt={key:0,class:"text-sm text-red-600"},Zt={key:1,class:"rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},ea={class:"text-sm font-medium text-blue-800 dark:text-blue-200"},ta={key:2,class:"rounded-lg bg-red-50 p-3 dark:bg-red-900/20"},aa={class:"text-sm font-medium text-red-800 dark:text-red-200"},sa={key:3,class:"rounded-lg bg-green-50 p-3 dark:bg-green-900/20"},da={class:"text-sm font-medium text-green-800 dark:text-green-200"},la={class:"grid gap-2"},na={key:0,class:"text-xs text-muted-foreground"},ra={key:1,class:"text-sm text-red-600"},oa={class:"grid gap-4 sm:grid-cols-2"},ia={class:"grid gap-2"},ua={key:0,class:"text-sm text-red-600"},ma={class:"grid gap-2"},fa={key:0,class:"text-sm text-red-600"},$a=Ee({__name:"Index",props:{payments:{},students:{},fees:{},credits:{},adjustedBalances:{},grades:{},terms:{},currentTerm:{},filters:{}},setup(ge){const b=ge,S=b.payments||[],R=b.students||[],L=b.fees||[],te=b.credits||{},ae=b.grades||[],xe=b.terms||[],H=q(!1),M=q(!1),O=q(null),z=q(!1),l=Z({grade:b.filters?.grade||"all",term:b.filters?.term||"all",status:b.filters?.status||"all",student:b.filters?.student||"all",date_from:b.filters?.date_from||"",date_to:b.filters?.date_to||"",has_balance:b.filters?.has_balance||"all",sort_balance:b.filters?.sort_balance||"all"}),be=[{title:"Dashboard",href:Ue().url},{title:"Fee Payments",href:De.index.url}],p=Z({student_adm_no:"",fee_id:"",amount_paid:"",payment_date:new Date().toISOString().split("T")[0]}),f=Z({student_adm_no:"",fee_id:"",amount_paid:"",payment_date:""}),J=()=>{p.reset(),p.payment_date=new Date().toISOString().split("T")[0]},se=()=>{f.reset()},ve=()=>{J(),H.value=!0},ce=()=>{p.post("/fee-payments",{onSuccess:()=>{H.value=!1,J()}})},ye=r=>{const t=S.find(a=>a.id===r);t&&(O.value=t.id,f.student_adm_no=t.student?.adm_no||"",f.fee_id=t.fee_id.toString(),f.amount_paid=t.amount_paid.toString(),f.payment_date=t.payment_date,M.value=!0)},ke=()=>{O.value&&f.put(`/fee-payments/${O.value}`,{onSuccess:()=>{M.value=!1,se()}})},we=r=>{confirm("Are you sure you want to delete this payment?")&&ee.delete(`/fee-payments/${r}`)},T=()=>{const r={};l.grade&&l.grade!=="all"&&(r.grade=l.grade),l.term&&l.term!=="all"&&(r.term=l.term),l.status&&l.status!=="all"&&(r.status=l.status),l.student&&l.student!=="all"&&(r.student=l.student),l.date_from&&(r.date_from=l.date_from),l.date_to&&(r.date_to=l.date_to),l.has_balance&&l.has_balance!=="all"&&(r.has_balance=l.has_balance),l.sort_balance&&l.sort_balance!=="all"&&(r.sort_balance=l.sort_balance),ee.get("/fee-payments",r,{preserveState:!1,preserveScroll:!1,only:["payments","filters"]})},de=()=>{l.grade="all",l.term="all",l.status="all",l.student="all",l.date_from="",l.date_to="",l.has_balance="all",l.sort_balance="all",ee.get("/fee-payments",{},{preserveState:!1,preserveScroll:!1})},X=h(()=>!!(l.grade&&l.grade!=="all"||l.term&&l.term!=="all"||l.status&&l.status!=="all"||l.student&&l.student!=="all"||l.date_from||l.date_to||l.has_balance&&l.has_balance!=="all"||l.sort_balance&&l.sort_balance!=="all")),C=r=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(r),Se=r=>r?new Date(r).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}):"Not paid",Ve=r=>{const t={paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",partial:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"};return t[r]||t.partial},Ce=S.reduce((r,t)=>r+parseFloat(t.amount_paid||0),0),he=S.filter(r=>r.status==="paid").length,Fe=S.filter(r=>r.status==="partial").length,y=h(()=>p.student_adm_no?R.find(r=>r.adm_no===p.student_adm_no):null),k=h(()=>f.student_adm_no?R.find(r=>r.adm_no===f.student_adm_no):null),Ae=h(()=>{const r=y.value;return!r||!r.grade_id?L:L.filter(t=>t.grade_id===r.grade_id)}),Pe=h(()=>{const r=k.value;return!r||!r.grade_id?L:L.filter(t=>t.grade_id===r.grade_id)}),le=(r,t)=>{if(!b.adjustedBalances)return null;const a=b.adjustedBalances[r];if(!a)return null;const g=a[t];return g?g.adjusted_balance:null},Q=h(()=>{if(!p.student_adm_no||!p.fee_id)return null;const r=y.value;if(!r)return null;const t=r.id.toString(),a=p.fee_id,g=le(t,a);if(g!==null)return g;const v=S.filter(w=>w.student_id.toString()===t&&w.fee_id.toString()===a);if(v.length===0){const w=L.find(Y=>Y.id.toString()===a);if(!w)return null;const W=G(t);return Math.max(0,w.amount-W)}return v[0].balance}),ne=h(()=>{if(!f.student_adm_no||!f.fee_id)return null;const r=k.value;if(!r)return null;const t=r.id.toString(),a=f.fee_id,g=le(t,a);if(g!==null)return g;const v=S.filter(w=>w.student_id.toString()===t&&w.fee_id.toString()===a&&w.id!==O.value);if(v.length===0){const w=L.find(Y=>Y.id.toString()===a);if(!w)return null;const W=G(t);return Math.max(0,w.amount-W)}return v[0].balance}),F=h(()=>{if(!p.student_adm_no||!p.fee_id)return!1;const r=y.value;if(!r)return!1;const t=r.id.toString(),a=p.fee_id,g=S.filter(v=>v.student_id.toString()===t&&v.fee_id.toString()===a);return g.length===0?!1:g[0].balance===0}),A=h(()=>{if(!f.student_adm_no||!f.fee_id)return!1;const r=k.value;if(!r)return!1;const t=r.id.toString(),a=f.fee_id,g=S.filter(v=>v.student_id.toString()===t&&v.fee_id.toString()===a&&v.id!==O.value);return g.length===0?!1:g[0].balance===0});re(()=>p.student_adm_no,()=>{p.fee_id=""}),re(()=>f.student_adm_no,()=>{f.fee_id=""});const G=r=>(te[r]||[]).reduce((g,v)=>g+parseFloat(v.amount||0),0),$e=Object.values(te).flat().reduce((r,t)=>r+parseFloat(t.amount||0),0);return(r,t)=>(u(),m(N,null,[s(e(Te),{title:"Fee Payments"}),s(Be,{breadcrumbs:be},{default:n(()=>[d("div",je,[d("div",Ne,[d("div",Le,[t[30]||(t[30]=d("div",{class:"text-sm font-medium text-muted-foreground"},"Total Payments",-1)),d("div",Ge,o(e(S).length),1)]),d("div",Ke,[t[31]||(t[31]=d("div",{class:"text-sm font-medium text-muted-foreground"},"Total Collected",-1)),d("div",Oe,o(C(e(Ce))),1)]),d("div",ze,[t[32]||(t[32]=d("div",{class:"text-sm font-medium text-muted-foreground"},"Paid / Partial",-1)),d("div",Re,o(e(he))+" / "+o(e(Fe)),1)]),d("div",He,[t[33]||(t[33]=d("div",{class:"text-sm font-medium text-muted-foreground"},"Available Credits",-1)),d("div",Me,o(C(e($e))),1)])]),d("div",Xe,[d("div",qe,[d("div",Je,[t[35]||(t[35]=d("h2",{class:"text-xl font-semibold"},"Fee Payments",-1)),d("div",Qe,[s(e(V),{variant:"outline",onClick:t[0]||(t[0]=a=>z.value=!z.value),class:"gap-2"},{default:n(()=>[s(e(Ie),{class:"h-4 w-4"}),t[34]||(t[34]=i(" Filters ",-1)),X.value?(u(),m("span",We," Active ")):_("",!0)]),_:1}),d("button",{onClick:ve,class:"rounded-lg bg-black px-4 py-2 text-sm font-medium text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200"}," + Record Payment ")])]),z.value?(u(),m("div",Ye,[d("div",Ze,[t[37]||(t[37]=d("h3",{class:"font-semibold"},"Filter Payments",-1)),X.value?(u(),j(e(V),{key:0,variant:"ghost",size:"sm",onClick:de,class:"gap-2 text-red-600 hover:text-red-700"},{default:n(()=>[s(e(I),{class:"h-4 w-4"}),t[36]||(t[36]=i(" Clear All ",-1))]),_:1})):_("",!0)]),d("div",et,[d("div",tt,[s(e(c),null,{default:n(()=>[...t[38]||(t[38]=[i("Grade",-1)])]),_:1}),s(e($),{modelValue:e(l).grade,"onUpdate:modelValue":t[1]||(t[1]=a=>e(l).grade=a)},{default:n(()=>[s(e(D),null,{default:n(()=>[s(e(B),{placeholder:"All Grades"})]),_:1}),s(e(U),null,{default:n(()=>[s(e(x),{value:"all"},{default:n(()=>[...t[39]||(t[39]=[i("All Grades",-1)])]),_:1}),(u(!0),m(N,null,K(e(ae),a=>(u(),j(e(x),{key:a.id,value:a.id.toString()},{default:n(()=>[i(o(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),d("div",at,[s(e(c),null,{default:n(()=>[...t[40]||(t[40]=[i("Term",-1)])]),_:1}),s(e($),{modelValue:e(l).term,"onUpdate:modelValue":t[2]||(t[2]=a=>e(l).term=a)},{default:n(()=>[s(e(D),null,{default:n(()=>[s(e(B),{placeholder:"All Terms"})]),_:1}),s(e(U),null,{default:n(()=>[s(e(x),{value:"all"},{default:n(()=>[...t[41]||(t[41]=[i("All Terms",-1)])]),_:1}),(u(!0),m(N,null,K(e(xe),a=>(u(),j(e(x),{key:a,value:a},{default:n(()=>[i(o(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),d("div",st,[s(e(c),null,{default:n(()=>[...t[42]||(t[42]=[i("Status",-1)])]),_:1}),s(e($),{modelValue:e(l).status,"onUpdate:modelValue":t[3]||(t[3]=a=>e(l).status=a)},{default:n(()=>[s(e(D),null,{default:n(()=>[s(e(B),{placeholder:"All Statuses"})]),_:1}),s(e(U),null,{default:n(()=>[s(e(x),{value:"all"},{default:n(()=>[...t[43]||(t[43]=[i("All Statuses",-1)])]),_:1}),s(e(x),{value:"paid"},{default:n(()=>[...t[44]||(t[44]=[i("Paid",-1)])]),_:1}),s(e(x),{value:"partial"},{default:n(()=>[...t[45]||(t[45]=[i("Partial",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),d("div",dt,[s(e(c),null,{default:n(()=>[...t[46]||(t[46]=[i("Student",-1)])]),_:1}),s(e($),{modelValue:e(l).student,"onUpdate:modelValue":t[4]||(t[4]=a=>e(l).student=a)},{default:n(()=>[s(e(D),null,{default:n(()=>[s(e(B),{placeholder:"All Students"})]),_:1}),s(e(U),null,{default:n(()=>[s(e(x),{value:"all"},{default:n(()=>[...t[47]||(t[47]=[i("All Students",-1)])]),_:1}),(u(!0),m(N,null,K(e(R),a=>(u(),j(e(x),{key:a.id,value:a.id.toString()},{default:n(()=>[i(o(a.first_name)+" "+o(a.last_name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),d("div",lt,[s(e(c),{for:"date_from"},{default:n(()=>[...t[48]||(t[48]=[i("Date From",-1)])]),_:1}),s(e(E),{id:"date_from",modelValue:e(l).date_from,"onUpdate:modelValue":t[5]||(t[5]=a=>e(l).date_from=a),type:"date",class:"w-full"},null,8,["modelValue"])]),d("div",nt,[s(e(c),{for:"date_to"},{default:n(()=>[...t[49]||(t[49]=[i("Date To",-1)])]),_:1}),s(e(E),{id:"date_to",modelValue:e(l).date_to,"onUpdate:modelValue":t[6]||(t[6]=a=>e(l).date_to=a),type:"date",class:"w-full"},null,8,["modelValue"])]),d("div",rt,[s(e(c),null,{default:n(()=>[...t[50]||(t[50]=[i("Balance Status",-1)])]),_:1}),s(e($),{modelValue:e(l).has_balance,"onUpdate:modelValue":t[7]||(t[7]=a=>e(l).has_balance=a)},{default:n(()=>[s(e(D),null,{default:n(()=>[s(e(B),{placeholder:"All"})]),_:1}),s(e(U),null,{default:n(()=>[s(e(x),{value:"all"},{default:n(()=>[...t[51]||(t[51]=[i("All",-1)])]),_:1}),s(e(x),{value:"yes"},{default:n(()=>[...t[52]||(t[52]=[i("Has Balance",-1)])]),_:1}),s(e(x),{value:"no"},{default:n(()=>[...t[53]||(t[53]=[i("Fully Paid",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),d("div",ot,[s(e(c),null,{default:n(()=>[...t[54]||(t[54]=[i("Sort by Balance",-1)])]),_:1}),s(e($),{modelValue:e(l).sort_balance,"onUpdate:modelValue":t[8]||(t[8]=a=>e(l).sort_balance=a)},{default:n(()=>[s(e(D),null,{default:n(()=>[s(e(B),{placeholder:"Default"})]),_:1}),s(e(U),null,{default:n(()=>[s(e(x),{value:"all"},{default:n(()=>[...t[55]||(t[55]=[i("Default (Latest First)",-1)])]),_:1}),s(e(x),{value:"asc"},{default:n(()=>[...t[56]||(t[56]=[i("Balance: Low to High",-1)])]),_:1}),s(e(x),{value:"desc"},{default:n(()=>[...t[57]||(t[57]=[i("Balance: High to Low",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),d("div",it,[s(e(V),{variant:"outline",onClick:t[9]||(t[9]=a=>z.value=!1)},{default:n(()=>[...t[58]||(t[58]=[i(" Close ",-1)])]),_:1}),s(e(V),{onClick:T,disabled:e(l).processing},{default:n(()=>[...t[59]||(t[59]=[i(" Apply Filters ",-1)])]),_:1},8,["disabled"])])])):_("",!0),X.value&&!z.value?(u(),m("div",ut,[t[60]||(t[60]=d("span",{class:"text-sm text-muted-foreground"},"Active filters:",-1)),e(l).grade&&e(l).grade!=="all"?(u(),m("span",mt,[i(" Grade: "+o(e(ae).find(a=>a.id.toString()===e(l).grade)?.name)+" ",1),d("button",{onClick:t[10]||(t[10]=a=>{e(l).grade="all",T()}),class:"hover:text-red-600"},[s(e(I),{class:"h-3 w-3"})])])):_("",!0),e(l).term&&e(l).term!=="all"?(u(),m("span",ft,[i(" Term: "+o(e(l).term)+" ",1),d("button",{onClick:t[11]||(t[11]=a=>{e(l).term="all",T()}),class:"hover:text-red-600"},[s(e(I),{class:"h-3 w-3"})])])):_("",!0),e(l).status&&e(l).status!=="all"?(u(),m("span",pt,[i(" Status: "+o(e(l).status)+" ",1),d("button",{onClick:t[12]||(t[12]=a=>{e(l).status="all",T()}),class:"hover:text-red-600"},[s(e(I),{class:"h-3 w-3"})])])):_("",!0),e(l).student&&e(l).student!=="all"?(u(),m("span",_t,[i(" Student: "+o(e(R).find(a=>a.id.toString()===e(l).student)?.first_name)+" ",1),d("button",{onClick:t[13]||(t[13]=a=>{e(l).student="all",T()}),class:"hover:text-red-600"},[s(e(I),{class:"h-3 w-3"})])])):_("",!0),e(l).date_from?(u(),m("span",gt,[i(" From: "+o(e(l).date_from)+" ",1),d("button",{onClick:t[14]||(t[14]=a=>{e(l).date_from="",T()}),class:"hover:text-red-600"},[s(e(I),{class:"h-3 w-3"})])])):_("",!0),e(l).date_to?(u(),m("span",xt,[i(" To: "+o(e(l).date_to)+" ",1),d("button",{onClick:t[15]||(t[15]=a=>{e(l).date_to="",T()}),class:"hover:text-red-600"},[s(e(I),{class:"h-3 w-3"})])])):_("",!0)])):_("",!0),d("div",bt,[d("table",vt,[t[63]||(t[63]=d("thead",{class:"bg-gray-50 dark:bg-sidebar-accent"},[d("tr",null,[d("th",null,"#"),d("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Student"),d("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Grade"),d("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Term"),d("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Amount Paid"),d("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Balance"),d("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Payment Date"),d("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Status"),d("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Actions")])],-1)),d("tbody",ct,[(u(!0),m(N,null,K(e(S),(a,g)=>(u(),m("tr",{key:a.id,class:P(["hover:bg-gray-50 dark:hover:bg-sidebar-accent",{"bg-muted/50":g%2===0}])},[d("td",yt,o(g+=1),1),d("td",kt,o(a.student?.first_name)+" "+o(a.student?.last_name),1),d("td",wt,o(a.fee?.grade?.name||"N/A"),1),d("td",St,o(a.fee?.term||"N/A"),1),d("td",Vt,o(C(a.amount_paid)),1),d("td",Ct,[a.balance>0?(u(),m("span",ht,o(C(a.balance)),1)):(u(),m("span",Ft," Paid "))]),d("td",At,o(Se(a.payment_date)),1),d("td",Pt,[d("span",{class:P([Ve(a.status),"rounded-full px-2 py-1 text-xs font-medium uppercase"])},o(a.status),3)]),d("td",$t,[d("div",Dt,[s(e(V),{variant:"ghost",size:"sm",onClick:v=>ye(a.id)},{default:n(()=>[...t[61]||(t[61]=[i(" Edit ",-1)])]),_:1},8,["onClick"]),s(e(V),{variant:"destructive",size:"sm",onClick:v=>we(a.id)},{default:n(()=>[...t[62]||(t[62]=[i(" Delete ",-1)])]),_:1},8,["onClick"])])])],2))),128))])]),e(S).length===0?(u(),m("div",Bt,[t[65]||(t[65]=d("p",{class:"text-muted-foreground"},"No payments found matching your filters.",-1)),X.value?(u(),j(e(V),{key:0,variant:"outline",class:"mt-4",onClick:de},{default:n(()=>[...t[64]||(t[64]=[i(" Clear Filters ",-1)])]),_:1})):_("",!0)])):_("",!0)])])])]),s(e(oe),{open:H.value,"onUpdate:open":t[22]||(t[22]=a=>H.value=a)},{default:n(()=>[s(e(ie),{class:"sm:max-w-2xl",onInteractOutside:t[20]||(t[20]=a=>a.preventDefault()),onEscapeKeyDown:t[21]||(t[21]=a=>a.preventDefault())},{default:n(()=>[s(e(ue),null,{default:n(()=>[s(e(me),null,{default:n(()=>[...t[66]||(t[66]=[i("Record New Payment",-1)])]),_:1}),s(e(fe),null,{default:n(()=>[...t[67]||(t[67]=[i(" Enter the payment details below. Status will be automatically calculated. ",-1)])]),_:1})]),_:1}),d("div",Ut,[d("div",Et,[s(e(c),{for:"student_adm_no"},{default:n(()=>[...t[68]||(t[68]=[i("Student Admission Number",-1)])]),_:1}),s(e(E),{id:"student_adm_no",modelValue:e(p).student_adm_no,"onUpdate:modelValue":t[16]||(t[16]=a=>e(p).student_adm_no=a),type:"text",placeholder:"Enter admission number (e.g., ADM001)",class:"w-full"},null,8,["modelValue"]),e(p).errors.student_adm_no?(u(),m("span",Tt,o(e(p).errors.student_adm_no),1)):_("",!0),y.value?(u(),m("div",It,[d("p",jt," âœ“ "+o(y.value.first_name)+" "+o(y.value.last_name)+" - "+o(y.value.grade?.name),1)])):_("",!0),e(p).student_adm_no&&!y.value?(u(),m("div",Nt,[d("p",Lt," âœ— Student not found with admission number: "+o(e(p).student_adm_no),1)])):_("",!0),y.value&&G(y.value.id.toString())>0?(u(),m("div",Gt,[d("p",Kt," ðŸ’° Available Credit: "+o(C(G(y.value.id.toString()))),1),t[69]||(t[69]=d("p",{class:"text-xs text-green-600 dark:text-green-400"}," This credit can be applied to future fees ",-1))])):_("",!0)]),d("div",Ot,[s(e(c),{for:"fee_id"},{default:n(()=>[...t[70]||(t[70]=[i("Fee",-1)])]),_:1}),s(e($),{modelValue:e(p).fee_id,"onUpdate:modelValue":t[17]||(t[17]=a=>e(p).fee_id=a),disabled:!y.value},{default:n(()=>[s(e(D),null,{default:n(()=>[s(e(B),{placeholder:"Select a fee"})]),_:1}),s(e(U),null,{default:n(()=>[(u(!0),m(N,null,K(Ae.value,a=>(u(),j(e(x),{key:a.id,value:a.id.toString()},{default:n(()=>[i(o(a.term)+" ("+o(C(a.amount))+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),y.value?_("",!0):(u(),m("span",zt,"Enter a valid admission number first")),e(p).errors.fee_id?(u(),m("span",Rt,o(e(p).errors.fee_id),1)):_("",!0)]),Q.value!==null&&e(p).fee_id?(u(),m("div",{key:0,class:P(["rounded-lg p-3",F.value?"bg-red-50 dark:bg-red-900/20":"bg-orange-50 dark:bg-orange-900/20"])},[d("p",{class:P(["text-sm font-medium",F.value?"text-red-800 dark:text-red-200":"text-orange-800 dark:text-orange-200"])},o(F.value?"ðŸš«":"ðŸ“Š")+" Current Balance: "+o(C(Q.value)),3),d("p",{class:P(["text-xs",F.value?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400"])},o(F.value?"âš ï¸ This fee has been fully paid. Additional payments are not allowed.":Q.value>0?"Amount remaining to be paid for this fee":"This fee has been fully paid"),3)],2)):_("",!0),d("div",Ht,[d("div",Mt,[s(e(c),{for:"amount_paid"},{default:n(()=>[...t[71]||(t[71]=[i("Amount Paid",-1)])]),_:1}),s(e(E),{id:"amount_paid",modelValue:e(p).amount_paid,"onUpdate:modelValue":t[18]||(t[18]=a=>e(p).amount_paid=a),type:"number",step:"0.01",placeholder:"15000.00",disabled:F.value},null,8,["modelValue","disabled"]),e(p).errors.amount_paid?(u(),m("span",Xt,o(e(p).errors.amount_paid),1)):_("",!0)]),d("div",qt,[s(e(c),{for:"payment_date"},{default:n(()=>[...t[72]||(t[72]=[i("Payment Date",-1)])]),_:1}),s(e(E),{id:"payment_date",modelValue:e(p).payment_date,"onUpdate:modelValue":t[19]||(t[19]=a=>e(p).payment_date=a),type:"date",disabled:F.value},null,8,["modelValue","disabled"]),e(p).errors.payment_date?(u(),m("span",Jt,o(e(p).errors.payment_date),1)):_("",!0)])]),t[73]||(t[73]=d("div",{class:"rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},[d("p",{class:"text-xs text-blue-800 dark:text-blue-200"}," â„¹ï¸ Payment status will be automatically calculated based on the balance ")],-1))]),s(e(pe),{class:"pt-4"},{default:n(()=>[s(e(_e),{"as-child":""},{default:n(()=>[s(e(V),{variant:"outline",onClick:J},{default:n(()=>[...t[74]||(t[74]=[i(" Cancel ",-1)])]),_:1})]),_:1}),s(e(V),{onClick:ce,disabled:e(p).processing||F.value||!y.value},{default:n(()=>[i(o(e(p).processing?"Recording...":"Record Payment"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(oe),{open:M.value,"onUpdate:open":t[29]||(t[29]=a=>M.value=a)},{default:n(()=>[s(e(ie),{class:"sm:max-w-2xl",onInteractOutside:t[27]||(t[27]=a=>a.preventDefault()),onEscapeKeyDown:t[28]||(t[28]=a=>a.preventDefault())},{default:n(()=>[s(e(ue),null,{default:n(()=>[s(e(me),null,{default:n(()=>[...t[75]||(t[75]=[i("Edit Payment",-1)])]),_:1}),s(e(fe),null,{default:n(()=>[...t[76]||(t[76]=[i(" Update the payment details. Status will be automatically recalculated. ",-1)])]),_:1})]),_:1}),d("div",Qt,[d("div",Wt,[s(e(c),{for:"edit_student_adm_no"},{default:n(()=>[...t[77]||(t[77]=[i("Student Admission Number",-1)])]),_:1}),s(e(E),{id:"edit_student_adm_no",modelValue:e(f).student_adm_no,"onUpdate:modelValue":t[23]||(t[23]=a=>e(f).student_adm_no=a),type:"text",placeholder:"Enter admission number",class:"w-full"},null,8,["modelValue"]),e(f).errors.student_adm_no?(u(),m("span",Yt,o(e(f).errors.student_adm_no),1)):_("",!0),k.value?(u(),m("div",Zt,[d("p",ea," âœ“ "+o(k.value.first_name)+" "+o(k.value.last_name)+" - "+o(k.value.grade?.name),1)])):_("",!0),e(f).student_adm_no&&!k.value?(u(),m("div",ta,[d("p",aa," âœ— Student not found with admission number: "+o(e(f).student_adm_no),1)])):_("",!0),k.value&&G(k.value.id.toString())>0?(u(),m("div",sa,[d("p",da," ðŸ’° Available Credit: "+o(C(G(k.value.id.toString()))),1)])):_("",!0)]),d("div",la,[s(e(c),{for:"edit_fee_id"},{default:n(()=>[...t[78]||(t[78]=[i("Fee",-1)])]),_:1}),s(e($),{modelValue:e(f).fee_id,"onUpdate:modelValue":t[24]||(t[24]=a=>e(f).fee_id=a),disabled:!k.value},{default:n(()=>[s(e(D),null,{default:n(()=>[s(e(B),{placeholder:"Select a fee"})]),_:1}),s(e(U),null,{default:n(()=>[(u(!0),m(N,null,K(Pe.value,a=>(u(),j(e(x),{key:a.id,value:a.id.toString()},{default:n(()=>[i(o(a.term)+" ("+o(C(a.amount))+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),k.value?_("",!0):(u(),m("span",na,"Enter a valid admission number first")),e(f).errors.fee_id?(u(),m("span",ra,o(e(f).errors.fee_id),1)):_("",!0)]),ne.value!==null&&e(f).fee_id?(u(),m("div",{key:0,class:P(["rounded-lg p-3",A.value?"bg-red-50 dark:bg-red-900/20":"bg-orange-50 dark:bg-orange-900/20"])},[d("p",{class:P(["text-sm font-medium",A.value?"text-red-800 dark:text-red-200":"text-orange-800 dark:text-orange-200"])},o(A.value?"ðŸš«":"ðŸ“Š")+" Current Balance: "+o(C(ne.value)),3),d("p",{class:P(["text-xs",A.value?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400"])},o(A.value?"âš ï¸ This fee has been fully paid. Cannot add more payments.":"Amount remaining after other payments"),3)],2)):_("",!0),d("div",oa,[d("div",ia,[s(e(c),{for:"edit_amount_paid"},{default:n(()=>[...t[79]||(t[79]=[i("Amount Paid",-1)])]),_:1}),s(e(E),{id:"edit_amount_paid",modelValue:e(f).amount_paid,"onUpdate:modelValue":t[25]||(t[25]=a=>e(f).amount_paid=a),type:"number",step:"0.01",placeholder:"15000.00",disabled:A.value},null,8,["modelValue","disabled"]),e(f).errors.amount_paid?(u(),m("span",ua,o(e(f).errors.amount_paid),1)):_("",!0)]),d("div",ma,[s(e(c),{for:"edit_payment_date"},{default:n(()=>[...t[80]||(t[80]=[i("Payment Date",-1)])]),_:1}),s(e(E),{id:"edit_payment_date",modelValue:e(f).payment_date,"onUpdate:modelValue":t[26]||(t[26]=a=>e(f).payment_date=a),type:"date",disabled:A.value},null,8,["modelValue","disabled"]),e(f).errors.payment_date?(u(),m("span",fa,o(e(f).errors.payment_date),1)):_("",!0)])]),t[81]||(t[81]=d("div",{class:"rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},[d("p",{class:"text-xs text-blue-800 dark:text-blue-200"}," â„¹ï¸ Payment status will be automatically recalculated based on the balance ")],-1))]),s(e(pe),{class:"pt-4"},{default:n(()=>[s(e(_e),{"as-child":""},{default:n(()=>[s(e(V),{variant:"outline",onClick:se},{default:n(()=>[...t[82]||(t[82]=[i(" Cancel ",-1)])]),_:1})]),_:1}),s(e(V),{onClick:ke,disabled:e(f).processing||A.value||!k.value},{default:n(()=>[i(o(e(f).processing?"Updating...":"Update Payment"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{$a as default};
