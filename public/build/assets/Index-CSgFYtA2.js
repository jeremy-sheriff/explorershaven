import{f as he,X as E,_ as Ae}from"./AppLayout.vue_vue_type_script_setup_true_lang-BbZWg5Wc.js";import{d as $e}from"./index-C4J_hXM0.js";import{d as De,f as H,g as Q,i as I,p as de,c as p,a as s,u as e,h as Be,w as d,b as l,t as o,j as _,k as n,o as u,l as P,F as h,r as B,e as U,m as W}from"./app-BWhTEcgP.js";import{_ as k}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DuHUTXgr.js";import{_ as le,a as re,b as ne,c as oe,d as ie}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BFRfdvAz.js";import{_ as ue,a as me}from"./DialogFooter.vue_vue_type_script_setup_true_lang-CycvLwV3.js";import{_ as S,a as V,b as C,c as F,d as x}from"./SelectValue.vue_vue_type_script_setup_true_lang-ZntikVup.js";import{_ as N}from"./Input.vue_vue_type_script_setup_true_lang-Bio_rAqW.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-DaJ2-AAD.js";import{F as Ue}from"./filter-Bgw6XHvD.js";import"./index-mhwJrAXB.js";import"./VisuallyHidden-DlU9HgWL.js";import"./useForwardExpose-D95vFiPf.js";import"./useForwardPropsEmits-gPxCdHKc.js";import"./createLucideIcon-Bt3CjKnB.js";import"./check-5ojpqPrW.js";import"./useFormControl-BKF91ilO.js";const Te={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},Ee={class:"grid auto-rows-min gap-4 md:grid-cols-4"},Ie={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},je={class:"text-2xl font-bold"},Le={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},Ne={class:"text-2xl font-bold"},Ge={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},Ke={class:"text-2xl font-bold"},Oe={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},ze={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Re={class:"relative min-h-[100vh] flex-1 rounded-xl border border-sidebar-border/70 bg-white md:min-h-min dark:border-sidebar-border dark:bg-sidebar"},He={class:"p-6"},Me={class:"mb-4 flex items-center justify-between"},Xe={class:"flex gap-2"},qe={key:0,class:"ml-1 rounded-full bg-primary px-2 py-0.5 text-xs text-primary-foreground"},Je={key:0,class:"mb-6 rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-sidebar-accent"},Qe={class:"mb-4 flex items-center justify-between"},We={class:"grid gap-4 md:grid-cols-2 lg:grid-cols-4"},Ye={class:"grid gap-2"},Ze={class:"grid gap-2"},et={class:"grid gap-2"},tt={class:"grid gap-2"},at={class:"grid gap-2"},st={class:"grid gap-2"},dt={class:"grid gap-2"},lt={class:"grid gap-2"},rt={class:"mt-4 flex justify-end gap-2"},nt={key:1,class:"mb-4 flex flex-wrap gap-2"},ot={key:0,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},it={key:1,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},ut={key:2,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},mt={key:3,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},ft={key:4,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},pt={key:5,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},_t={class:"overflow-x-auto"},gt={class:"min-w-full divide-y divide-gray-200"},xt={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-sidebar"},bt={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},yt={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},vt={class:"whitespace-nowrap px-6 py-4 text-sm"},ct={class:"whitespace-nowrap px-6 py-4 text-sm"},kt={class:"whitespace-nowrap px-6 py-4 text-sm font-semibold"},wt={class:"whitespace-nowrap px-6 py-4 text-sm"},St={key:0,class:"font-semibold text-orange-600 dark:text-orange-400"},Vt={key:1,class:"font-semibold text-green-600 dark:text-green-400"},Ct={class:"whitespace-nowrap px-6 py-4 text-sm"},Ft={class:"whitespace-nowrap px-6 py-4 text-sm"},Pt={class:"whitespace-nowrap px-6 py-4 text-right"},ht={class:"flex items-center justify-end gap-2"},At={key:0,class:"py-12 text-center"},$t={class:"grid gap-4 py-4"},Dt={class:"grid gap-2"},Bt={key:0,class:"text-sm text-red-600"},Ut={key:1,class:"rounded-lg bg-green-50 p-3 dark:bg-green-900/20"},Tt={class:"text-sm font-medium text-green-800 dark:text-green-200"},Et={class:"grid gap-2"},It={key:0,class:"text-xs text-muted-foreground"},jt={key:1,class:"text-sm text-red-600"},Lt={class:"grid gap-4 sm:grid-cols-2"},Nt={class:"grid gap-2"},Gt={key:0,class:"text-sm text-red-600"},Kt={class:"grid gap-2"},Ot={key:0,class:"text-sm text-red-600"},zt={class:"grid gap-4 py-4"},Rt={class:"grid gap-2"},Ht={key:0,class:"text-sm text-red-600"},Mt={key:1,class:"rounded-lg bg-green-50 p-3 dark:bg-green-900/20"},Xt={class:"text-sm font-medium text-green-800 dark:text-green-200"},qt={class:"grid gap-2"},Jt={key:0,class:"text-xs text-muted-foreground"},Qt={key:1,class:"text-sm text-red-600"},Wt={class:"grid gap-4 sm:grid-cols-2"},Yt={class:"grid gap-2"},Zt={key:0,class:"text-sm text-red-600"},ea={class:"grid gap-2"},ta={key:0,class:"text-sm text-red-600"},va=De({__name:"Index",props:{payments:{},students:{},fees:{},credits:{},adjustedBalances:{},grades:{},terms:{},currentTerm:{},filters:{}},setup(fe){const b=fe,c=b.payments||[],j=b.students||[],A=b.fees||[],Y=b.credits||{},Z=b.grades||[],pe=b.terms||[],O=H(!1),z=H(!1),G=H(null),K=H(!1),r=Q({grade:b.filters?.grade||"all",term:b.filters?.term||"all",status:b.filters?.status||"all",student:b.filters?.student||"all",date_from:b.filters?.date_from||"",date_to:b.filters?.date_to||"",has_balance:b.filters?.has_balance||"all",sort_balance:b.filters?.sort_balance||"all"}),_e=[{title:"Dashboard",href:$e().url},{title:"Fee Payments",href:he.index.url}],f=Q({student_id:"",fee_id:"",amount_paid:"",payment_date:new Date().toISOString().split("T")[0]}),m=Q({student_id:"",fee_id:"",amount_paid:"",payment_date:""}),M=()=>{f.reset(),f.payment_date=new Date().toISOString().split("T")[0]},ee=()=>{m.reset()},ge=()=>{M(),O.value=!0},xe=()=>{f.post("/fee-payments",{onSuccess:()=>{O.value=!1,M()}})},be=i=>{const t=c.find(a=>a.id===i);t&&(G.value=t.id,m.student_id=t.student_id.toString(),m.fee_id=t.fee_id.toString(),m.amount_paid=t.amount_paid.toString(),m.payment_date=t.payment_date,z.value=!0)},ye=()=>{G.value&&m.put(`/fee-payments/${G.value}`,{onSuccess:()=>{z.value=!1,ee()}})},ve=i=>{confirm("Are you sure you want to delete this payment?")&&W.delete(`/fee-payments/${i}`)},T=()=>{const i={};r.grade&&r.grade!=="all"&&(i.grade=r.grade),r.term&&r.term!=="all"&&(i.term=r.term),r.status&&r.status!=="all"&&(i.status=r.status),r.student&&r.student!=="all"&&(i.student=r.student),r.date_from&&(i.date_from=r.date_from),r.date_to&&(i.date_to=r.date_to),r.has_balance&&r.has_balance!=="all"&&(i.has_balance=r.has_balance),r.sort_balance&&r.sort_balance!=="all"&&(i.sort_balance=r.sort_balance),W.get("/fee-payments",i,{preserveState:!1,preserveScroll:!1,only:["payments","filters"]})},te=()=>{r.grade="all",r.term="all",r.status="all",r.student="all",r.date_from="",r.date_to="",r.has_balance="all",r.sort_balance="all",W.get("/fee-payments",{},{preserveState:!1,preserveScroll:!1})},R=I(()=>!!(r.grade&&r.grade!=="all"||r.term&&r.term!=="all"||r.status&&r.status!=="all"||r.student&&r.student!=="all"||r.date_from||r.date_to||r.has_balance&&r.has_balance!=="all"||r.sort_balance&&r.sort_balance!=="all")),w=i=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(i),ce=i=>i?new Date(i).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}):"Not paid",ke=i=>{const t={paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",partial:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"};return t[i]||t.partial},we=c.reduce((i,t)=>i+parseFloat(t.amount_paid||0),0),Se=c.filter(i=>i.status==="paid").length,Ve=c.filter(i=>i.status==="partial").length,Ce=I(()=>{if(!f.student_id)return A;const i=j.find(t=>t.id.toString()===f.student_id);return!i||!i.grade_id?A:A.filter(t=>t.grade_id===i.grade_id)}),Fe=I(()=>{if(!m.student_id)return A;const i=j.find(t=>t.id.toString()===m.student_id);return!i||!i.grade_id?A:A.filter(t=>t.grade_id===i.grade_id)}),ae=(i,t)=>{if(!b.adjustedBalances)return null;const a=b.adjustedBalances[i];if(!a)return null;const g=a[t];return g?g.adjusted_balance:null},X=I(()=>{if(!f.student_id||!f.fee_id)return null;const i=f.student_id,t=f.fee_id,a=ae(i,t);if(a!==null)return a;const g=c.filter(y=>y.student_id.toString()===i&&y.fee_id.toString()===t);if(g.length===0){const y=A.find(J=>J.id.toString()===t);if(!y)return null;const q=L(i);return Math.max(0,y.amount-q)}return g[0].balance}),se=I(()=>{if(!m.student_id||!m.fee_id)return null;const i=m.student_id,t=m.fee_id,a=ae(i,t);if(a!==null)return a;const g=c.filter(y=>y.student_id.toString()===i&&y.fee_id.toString()===t&&y.id!==G.value);if(g.length===0){const y=A.find(J=>J.id.toString()===t);if(!y)return null;const q=L(i);return Math.max(0,y.amount-q)}return g[0].balance}),$=I(()=>{if(!f.student_id||!f.fee_id)return!1;const i=f.student_id,t=f.fee_id,a=c.filter(g=>g.student_id.toString()===i&&g.fee_id.toString()===t);return a.length===0?!1:a[0].balance===0}),D=I(()=>{if(!m.student_id||!m.fee_id)return!1;const i=m.student_id,t=m.fee_id,a=c.filter(g=>g.student_id.toString()===i&&g.fee_id.toString()===t&&g.id!==G.value);return a.length===0?!1:a[0].balance===0});de(()=>f.student_id,()=>{f.fee_id=""}),de(()=>m.student_id,()=>{m.fee_id=""});const L=i=>(Y[i]||[]).reduce((g,y)=>g+parseFloat(y.amount||0),0),Pe=Object.values(Y).flat().reduce((i,t)=>i+parseFloat(t.amount||0),0);return(i,t)=>(u(),p(h,null,[s(e(Be),{title:"Fee Payments"}),s(Ae,{breadcrumbs:_e},{default:d(()=>[l("div",Te,[l("div",Ee,[l("div",Ie,[t[30]||(t[30]=l("div",{class:"text-sm font-medium text-muted-foreground"},"Total Payments",-1)),l("div",je,o(e(c).length),1)]),l("div",Le,[t[31]||(t[31]=l("div",{class:"text-sm font-medium text-muted-foreground"},"Total Collected",-1)),l("div",Ne,o(w(e(we))),1)]),l("div",Ge,[t[32]||(t[32]=l("div",{class:"text-sm font-medium text-muted-foreground"},"Paid / Partial",-1)),l("div",Ke,o(e(Se))+" / "+o(e(Ve)),1)]),l("div",Oe,[t[33]||(t[33]=l("div",{class:"text-sm font-medium text-muted-foreground"},"Available Credits",-1)),l("div",ze,o(w(e(Pe))),1)])]),l("div",Re,[l("div",He,[l("div",Me,[t[35]||(t[35]=l("h2",{class:"text-xl font-semibold"},"Fee Payments",-1)),l("div",Xe,[s(e(k),{variant:"outline",onClick:t[0]||(t[0]=a=>K.value=!K.value),class:"gap-2"},{default:d(()=>[s(e(Ue),{class:"h-4 w-4"}),t[34]||(t[34]=n(" Filters ",-1)),R.value?(u(),p("span",qe," Active ")):_("",!0)]),_:1}),l("button",{onClick:ge,class:"rounded-lg bg-black px-4 py-2 text-sm font-medium text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200"}," + Record Payment ")])]),K.value?(u(),p("div",Je,[l("div",Qe,[t[37]||(t[37]=l("h3",{class:"font-semibold"},"Filter Payments",-1)),R.value?(u(),P(e(k),{key:0,variant:"ghost",size:"sm",onClick:te,class:"gap-2 text-red-600 hover:text-red-700"},{default:d(()=>[s(e(E),{class:"h-4 w-4"}),t[36]||(t[36]=n(" Clear All ",-1))]),_:1})):_("",!0)]),l("div",We,[l("div",Ye,[s(e(v),null,{default:d(()=>[...t[38]||(t[38]=[n("Grade",-1)])]),_:1}),s(e(S),{modelValue:e(r).grade,"onUpdate:modelValue":t[1]||(t[1]=a=>e(r).grade=a)},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"All Grades"})]),_:1}),s(e(F),null,{default:d(()=>[s(e(x),{value:"all"},{default:d(()=>[...t[39]||(t[39]=[n("All Grades",-1)])]),_:1}),(u(!0),p(h,null,B(e(Z),a=>(u(),P(e(x),{key:a.id,value:a.id.toString()},{default:d(()=>[n(o(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),l("div",Ze,[s(e(v),null,{default:d(()=>[...t[40]||(t[40]=[n("Term",-1)])]),_:1}),s(e(S),{modelValue:e(r).term,"onUpdate:modelValue":t[2]||(t[2]=a=>e(r).term=a)},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"All Terms"})]),_:1}),s(e(F),null,{default:d(()=>[s(e(x),{value:"all"},{default:d(()=>[...t[41]||(t[41]=[n("All Terms",-1)])]),_:1}),(u(!0),p(h,null,B(e(pe),a=>(u(),P(e(x),{key:a,value:a},{default:d(()=>[n(o(a),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),l("div",et,[s(e(v),null,{default:d(()=>[...t[42]||(t[42]=[n("Status",-1)])]),_:1}),s(e(S),{modelValue:e(r).status,"onUpdate:modelValue":t[3]||(t[3]=a=>e(r).status=a)},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"All Statuses"})]),_:1}),s(e(F),null,{default:d(()=>[s(e(x),{value:"all"},{default:d(()=>[...t[43]||(t[43]=[n("All Statuses",-1)])]),_:1}),s(e(x),{value:"paid"},{default:d(()=>[...t[44]||(t[44]=[n("Paid",-1)])]),_:1}),s(e(x),{value:"partial"},{default:d(()=>[...t[45]||(t[45]=[n("Partial",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l("div",tt,[s(e(v),null,{default:d(()=>[...t[46]||(t[46]=[n("Student",-1)])]),_:1}),s(e(S),{modelValue:e(r).student,"onUpdate:modelValue":t[4]||(t[4]=a=>e(r).student=a)},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"All Students"})]),_:1}),s(e(F),null,{default:d(()=>[s(e(x),{value:"all"},{default:d(()=>[...t[47]||(t[47]=[n("All Students",-1)])]),_:1}),(u(!0),p(h,null,B(e(j),a=>(u(),P(e(x),{key:a.id,value:a.id.toString()},{default:d(()=>[n(o(a.first_name)+" "+o(a.last_name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),l("div",at,[s(e(v),{for:"date_from"},{default:d(()=>[...t[48]||(t[48]=[n("Date From",-1)])]),_:1}),s(e(N),{id:"date_from",modelValue:e(r).date_from,"onUpdate:modelValue":t[5]||(t[5]=a=>e(r).date_from=a),type:"date",class:"w-full"},null,8,["modelValue"])]),l("div",st,[s(e(v),{for:"date_to"},{default:d(()=>[...t[49]||(t[49]=[n("Date To",-1)])]),_:1}),s(e(N),{id:"date_to",modelValue:e(r).date_to,"onUpdate:modelValue":t[6]||(t[6]=a=>e(r).date_to=a),type:"date",class:"w-full"},null,8,["modelValue"])]),l("div",dt,[s(e(v),null,{default:d(()=>[...t[50]||(t[50]=[n("Balance Status",-1)])]),_:1}),s(e(S),{modelValue:e(r).has_balance,"onUpdate:modelValue":t[7]||(t[7]=a=>e(r).has_balance=a)},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"All"})]),_:1}),s(e(F),null,{default:d(()=>[s(e(x),{value:"all"},{default:d(()=>[...t[51]||(t[51]=[n("All",-1)])]),_:1}),s(e(x),{value:"yes"},{default:d(()=>[...t[52]||(t[52]=[n("Has Balance",-1)])]),_:1}),s(e(x),{value:"no"},{default:d(()=>[...t[53]||(t[53]=[n("Fully Paid",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l("div",lt,[s(e(v),null,{default:d(()=>[...t[54]||(t[54]=[n("Sort by Balance",-1)])]),_:1}),s(e(S),{modelValue:e(r).sort_balance,"onUpdate:modelValue":t[8]||(t[8]=a=>e(r).sort_balance=a)},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"Default"})]),_:1}),s(e(F),null,{default:d(()=>[s(e(x),{value:"all"},{default:d(()=>[...t[55]||(t[55]=[n("Default (Latest First)",-1)])]),_:1}),s(e(x),{value:"asc"},{default:d(()=>[...t[56]||(t[56]=[n("Balance: Low to High",-1)])]),_:1}),s(e(x),{value:"desc"},{default:d(()=>[...t[57]||(t[57]=[n("Balance: High to Low",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),l("div",rt,[s(e(k),{variant:"outline",onClick:t[9]||(t[9]=a=>K.value=!1)},{default:d(()=>[...t[58]||(t[58]=[n(" Close ",-1)])]),_:1}),s(e(k),{onClick:T,disabled:e(r).processing},{default:d(()=>[...t[59]||(t[59]=[n(" Apply Filters ",-1)])]),_:1},8,["disabled"])])])):_("",!0),R.value&&!K.value?(u(),p("div",nt,[t[60]||(t[60]=l("span",{class:"text-sm text-muted-foreground"},"Active filters:",-1)),e(r).grade&&e(r).grade!=="all"?(u(),p("span",ot,[n(" Grade: "+o(e(Z).find(a=>a.id.toString()===e(r).grade)?.name)+" ",1),l("button",{onClick:t[10]||(t[10]=a=>{e(r).grade="all",T()}),class:"hover:text-red-600"},[s(e(E),{class:"h-3 w-3"})])])):_("",!0),e(r).term&&e(r).term!=="all"?(u(),p("span",it,[n(" Term: "+o(e(r).term)+" ",1),l("button",{onClick:t[11]||(t[11]=a=>{e(r).term="all",T()}),class:"hover:text-red-600"},[s(e(E),{class:"h-3 w-3"})])])):_("",!0),e(r).status&&e(r).status!=="all"?(u(),p("span",ut,[n(" Status: "+o(e(r).status)+" ",1),l("button",{onClick:t[12]||(t[12]=a=>{e(r).status="all",T()}),class:"hover:text-red-600"},[s(e(E),{class:"h-3 w-3"})])])):_("",!0),e(r).student&&e(r).student!=="all"?(u(),p("span",mt,[n(" Student: "+o(e(j).find(a=>a.id.toString()===e(r).student)?.first_name)+" ",1),l("button",{onClick:t[13]||(t[13]=a=>{e(r).student="all",T()}),class:"hover:text-red-600"},[s(e(E),{class:"h-3 w-3"})])])):_("",!0),e(r).date_from?(u(),p("span",ft,[n(" From: "+o(e(r).date_from)+" ",1),l("button",{onClick:t[14]||(t[14]=a=>{e(r).date_from="",T()}),class:"hover:text-red-600"},[s(e(E),{class:"h-3 w-3"})])])):_("",!0),e(r).date_to?(u(),p("span",pt,[n(" To: "+o(e(r).date_to)+" ",1),l("button",{onClick:t[15]||(t[15]=a=>{e(r).date_to="",T()}),class:"hover:text-red-600"},[s(e(E),{class:"h-3 w-3"})])])):_("",!0)])):_("",!0),l("div",_t,[l("table",gt,[t[63]||(t[63]=l("thead",{class:"bg-gray-50 dark:bg-sidebar-accent"},[l("tr",null,[l("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Student"),l("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Grade"),l("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Term"),l("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Amount Paid"),l("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Balance"),l("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Payment Date"),l("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Status"),l("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Actions")])],-1)),l("tbody",xt,[(u(!0),p(h,null,B(e(c),(a,g)=>(u(),p("tr",{key:a.id,class:U(["hover:bg-gray-50 dark:hover:bg-sidebar-accent",{"bg-muted/50":g%2===0}])},[l("td",bt,o(g+=1),1),l("td",yt,o(a.student?.first_name)+" "+o(a.student?.last_name),1),l("td",vt,o(a.fee?.grade?.name||"N/A"),1),l("td",ct,o(a.fee?.term||"N/A"),1),l("td",kt,o(w(a.amount_paid)),1),l("td",wt,[a.balance>0?(u(),p("span",St,o(w(a.balance)),1)):(u(),p("span",Vt," Paid "))]),l("td",Ct,o(ce(a.payment_date)),1),l("td",Ft,[l("span",{class:U([ke(a.status),"rounded-full px-2 py-1 text-xs font-medium uppercase"])},o(a.status),3)]),l("td",Pt,[l("div",ht,[s(e(k),{variant:"ghost",size:"sm",onClick:y=>be(a.id)},{default:d(()=>[...t[61]||(t[61]=[n(" Edit ",-1)])]),_:1},8,["onClick"]),s(e(k),{variant:"destructive",size:"sm",onClick:y=>ve(a.id)},{default:d(()=>[...t[62]||(t[62]=[n(" Delete ",-1)])]),_:1},8,["onClick"])])])],2))),128))])]),e(c).length===0?(u(),p("div",At,[t[65]||(t[65]=l("p",{class:"text-muted-foreground"},"No payments found matching your filters.",-1)),R.value?(u(),P(e(k),{key:0,variant:"outline",class:"mt-4",onClick:te},{default:d(()=>[...t[64]||(t[64]=[n(" Clear Filters ",-1)])]),_:1})):_("",!0)])):_("",!0)])])])]),s(e(le),{open:O.value,"onUpdate:open":t[22]||(t[22]=a=>O.value=a)},{default:d(()=>[s(e(re),{class:"sm:max-w-2xl",onInteractOutside:t[20]||(t[20]=a=>a.preventDefault()),onEscapeKeyDown:t[21]||(t[21]=a=>a.preventDefault())},{default:d(()=>[s(e(ne),null,{default:d(()=>[s(e(oe),null,{default:d(()=>[...t[66]||(t[66]=[n("Record New Payment",-1)])]),_:1}),s(e(ie),null,{default:d(()=>[...t[67]||(t[67]=[n(" Enter the payment details below. Status will be automatically calculated. ",-1)])]),_:1})]),_:1}),l("div",$t,[l("div",Dt,[s(e(v),{for:"student_id"},{default:d(()=>[...t[68]||(t[68]=[n("Student",-1)])]),_:1}),s(e(S),{modelValue:e(f).student_id,"onUpdate:modelValue":t[16]||(t[16]=a=>e(f).student_id=a)},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"Select a student"})]),_:1}),s(e(F),null,{default:d(()=>[(u(!0),p(h,null,B(e(j),a=>(u(),P(e(x),{key:a.id,value:a.id.toString()},{default:d(()=>[n(o(a.first_name)+" "+o(a.last_name)+" - "+o(a.adm_no)+" ("+o(a.grade?.name)+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(f).errors.student_id?(u(),p("span",Bt,o(e(f).errors.student_id),1)):_("",!0),e(f).student_id&&L(e(f).student_id)>0?(u(),p("div",Ut,[l("p",Tt," ðŸ’° Available Credit: "+o(w(L(e(f).student_id))),1),t[69]||(t[69]=l("p",{class:"text-xs text-green-600 dark:text-green-400"}," This credit can be applied to future fees ",-1))])):_("",!0)]),l("div",Et,[s(e(v),{for:"fee_id"},{default:d(()=>[...t[70]||(t[70]=[n("Fee",-1)])]),_:1}),s(e(S),{modelValue:e(f).fee_id,"onUpdate:modelValue":t[17]||(t[17]=a=>e(f).fee_id=a),disabled:!e(f).student_id},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"Select a fee"})]),_:1}),s(e(F),null,{default:d(()=>[(u(!0),p(h,null,B(Ce.value,a=>(u(),P(e(x),{key:a.id,value:a.id.toString()},{default:d(()=>[n(o(a.term)+" ("+o(w(a.amount))+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),e(f).student_id?_("",!0):(u(),p("span",It,"Select a student first")),e(f).errors.fee_id?(u(),p("span",jt,o(e(f).errors.fee_id),1)):_("",!0)]),X.value!==null&&e(f).fee_id?(u(),p("div",{key:0,class:U(["rounded-lg p-3",$.value?"bg-red-50 dark:bg-red-900/20":"bg-orange-50 dark:bg-orange-900/20"])},[l("p",{class:U(["text-sm font-medium",$.value?"text-red-800 dark:text-red-200":"text-orange-800 dark:text-orange-200"])},o($.value?"ðŸš«":"ðŸ“Š")+" Current Balance: "+o(w(X.value)),3),l("p",{class:U(["text-xs",$.value?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400"])},o($.value?"âš ï¸ This fee has been fully paid. Additional payments are not allowed.":X.value>0?"Amount remaining to be paid for this fee":"This fee has been fully paid"),3)],2)):_("",!0),l("div",Lt,[l("div",Nt,[s(e(v),{for:"amount_paid"},{default:d(()=>[...t[71]||(t[71]=[n("Amount Paid",-1)])]),_:1}),s(e(N),{id:"amount_paid",modelValue:e(f).amount_paid,"onUpdate:modelValue":t[18]||(t[18]=a=>e(f).amount_paid=a),type:"number",step:"0.01",placeholder:"15000.00",disabled:$.value},null,8,["modelValue","disabled"]),e(f).errors.amount_paid?(u(),p("span",Gt,o(e(f).errors.amount_paid),1)):_("",!0)]),l("div",Kt,[s(e(v),{for:"payment_date"},{default:d(()=>[...t[72]||(t[72]=[n("Payment Date",-1)])]),_:1}),s(e(N),{id:"payment_date",modelValue:e(f).payment_date,"onUpdate:modelValue":t[19]||(t[19]=a=>e(f).payment_date=a),type:"date",disabled:$.value},null,8,["modelValue","disabled"]),e(f).errors.payment_date?(u(),p("span",Ot,o(e(f).errors.payment_date),1)):_("",!0)])]),t[73]||(t[73]=l("div",{class:"rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},[l("p",{class:"text-xs text-blue-800 dark:text-blue-200"}," â„¹ï¸ Payment status will be automatically calculated based on the balance ")],-1))]),s(e(ue),{class:"pt-4"},{default:d(()=>[s(e(me),{"as-child":""},{default:d(()=>[s(e(k),{variant:"outline",onClick:M},{default:d(()=>[...t[74]||(t[74]=[n(" Cancel ",-1)])]),_:1})]),_:1}),s(e(k),{onClick:xe,disabled:e(f).processing||$.value},{default:d(()=>[n(o(e(f).processing?"Recording...":"Record Payment"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(le),{open:z.value,"onUpdate:open":t[29]||(t[29]=a=>z.value=a)},{default:d(()=>[s(e(re),{class:"sm:max-w-2xl",onInteractOutside:t[27]||(t[27]=a=>a.preventDefault()),onEscapeKeyDown:t[28]||(t[28]=a=>a.preventDefault())},{default:d(()=>[s(e(ne),null,{default:d(()=>[s(e(oe),null,{default:d(()=>[...t[75]||(t[75]=[n("Edit Payment",-1)])]),_:1}),s(e(ie),null,{default:d(()=>[...t[76]||(t[76]=[n(" Update the payment details. Status will be automatically recalculated. ",-1)])]),_:1})]),_:1}),l("div",zt,[l("div",Rt,[s(e(v),{for:"edit_student_id"},{default:d(()=>[...t[77]||(t[77]=[n("Student",-1)])]),_:1}),s(e(S),{modelValue:e(m).student_id,"onUpdate:modelValue":t[23]||(t[23]=a=>e(m).student_id=a)},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"Select a student"})]),_:1}),s(e(F),null,{default:d(()=>[(u(!0),p(h,null,B(e(j),a=>(u(),P(e(x),{key:a.id,value:a.id.toString()},{default:d(()=>[n(o(a.first_name)+" "+o(a.last_name)+" - "+o(a.adm_no)+" ("+o(a.grade?.name)+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(m).errors.student_id?(u(),p("span",Ht,o(e(m).errors.student_id),1)):_("",!0),e(m).student_id&&L(e(m).student_id)>0?(u(),p("div",Mt,[l("p",Xt," ðŸ’° Available Credit: "+o(w(L(e(m).student_id))),1)])):_("",!0)]),l("div",qt,[s(e(v),{for:"edit_fee_id"},{default:d(()=>[...t[78]||(t[78]=[n("Fee",-1)])]),_:1}),s(e(S),{modelValue:e(m).fee_id,"onUpdate:modelValue":t[24]||(t[24]=a=>e(m).fee_id=a),disabled:!e(m).student_id},{default:d(()=>[s(e(V),null,{default:d(()=>[s(e(C),{placeholder:"Select a fee"})]),_:1}),s(e(F),null,{default:d(()=>[(u(!0),p(h,null,B(Fe.value,a=>(u(),P(e(x),{key:a.id,value:a.id.toString()},{default:d(()=>[n(o(a.term)+" ("+o(w(a.amount))+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),e(m).student_id?_("",!0):(u(),p("span",Jt,"Select a student first")),e(m).errors.fee_id?(u(),p("span",Qt,o(e(m).errors.fee_id),1)):_("",!0)]),se.value!==null&&e(m).fee_id?(u(),p("div",{key:0,class:U(["rounded-lg p-3",D.value?"bg-red-50 dark:bg-red-900/20":"bg-orange-50 dark:bg-orange-900/20"])},[l("p",{class:U(["text-sm font-medium",D.value?"text-red-800 dark:text-red-200":"text-orange-800 dark:text-orange-200"])},o(D.value?"ðŸš«":"ðŸ“Š")+" Current Balance: "+o(w(se.value)),3),l("p",{class:U(["text-xs",D.value?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400"])},o(D.value?"âš ï¸ This fee has been fully paid. Cannot add more payments.":"Amount remaining after other payments"),3)],2)):_("",!0),l("div",Wt,[l("div",Yt,[s(e(v),{for:"edit_amount_paid"},{default:d(()=>[...t[79]||(t[79]=[n("Amount Paid",-1)])]),_:1}),s(e(N),{id:"edit_amount_paid",modelValue:e(m).amount_paid,"onUpdate:modelValue":t[25]||(t[25]=a=>e(m).amount_paid=a),type:"number",step:"0.01",placeholder:"15000.00",disabled:D.value},null,8,["modelValue","disabled"]),e(m).errors.amount_paid?(u(),p("span",Zt,o(e(m).errors.amount_paid),1)):_("",!0)]),l("div",ea,[s(e(v),{for:"edit_payment_date"},{default:d(()=>[...t[80]||(t[80]=[n("Payment Date",-1)])]),_:1}),s(e(N),{id:"edit_payment_date",modelValue:e(m).payment_date,"onUpdate:modelValue":t[26]||(t[26]=a=>e(m).payment_date=a),type:"date",disabled:D.value},null,8,["modelValue","disabled"]),e(m).errors.payment_date?(u(),p("span",ta,o(e(m).errors.payment_date),1)):_("",!0)])]),t[81]||(t[81]=l("div",{class:"rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},[l("p",{class:"text-xs text-blue-800 dark:text-blue-200"}," â„¹ï¸ Payment status will be automatically recalculated based on the balance ")],-1))]),s(e(ue),{class:"pt-4"},{default:d(()=>[s(e(me),{"as-child":""},{default:d(()=>[s(e(k),{variant:"outline",onClick:ee},{default:d(()=>[...t[82]||(t[82]=[n(" Cancel ",-1)])]),_:1})]),_:1}),s(e(k),{onClick:ye,disabled:e(m).processing||D.value},{default:d(()=>[n(o(e(m).processing?"Updating...":"Update Payment"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{va as default};
