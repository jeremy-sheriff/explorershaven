import{f as oe,_ as re}from"./AppLayout.vue_vue_type_script_setup_true_lang-HU9ICqVg.js";import{d as le}from"./index-C4J_hXM0.js";import{d as ne,f as E,g as T,c as p,a as d,u as e,h as ie,w as a,b as o,t as r,o as u,F as y,r as V,e as K,i as l,j as f,k as h,l as ue}from"./app-DlDbTRfK.js";import{_ as v}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-EK1quexj.js";import{_ as L,a as B,b as O,c as R,d as j}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D2ilQPmv.js";import{_ as z,a as G}from"./DialogFooter.vue_vue_type_script_setup_true_lang-DtSCsi2C.js";import{_ as b,a as c,b as k,c as w,d as _}from"./SelectValue.vue_vue_type_script_setup_true_lang-B8HdM_Mi.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-BtiGLV1B.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-DtmIzdiy.js";import"./index-B-MZF_ug.js";import"./VisuallyHidden-DdUA2duO.js";import"./useForwardExpose-B9bAqDBO.js";import"./useForwardPropsEmits-DwR8ao0K.js";import"./createLucideIcon-DdCD22z6.js";import"./check-D-FW0PdI.js";import"./useFormControl-z9Ufgc9Q.js";const me={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},pe={class:"grid auto-rows-min gap-4 md:grid-cols-3"},fe={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},_e={class:"text-2xl font-bold"},xe={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},ge={class:"text-2xl font-bold"},ye={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},ve={class:"text-2xl font-bold"},be={class:"relative min-h-[100vh] flex-1 rounded-xl border border-sidebar-border/70 bg-white md:min-h-min dark:border-sidebar-border dark:bg-sidebar"},ce={class:"p-6"},ke={class:"overflow-x-auto"},we={class:"min-w-full divide-y divide-gray-200"},Ve={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-sidebar"},Pe={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},Se={class:"whitespace-nowrap px-6 py-4 text-sm"},Ce={class:"whitespace-nowrap px-6 py-4 text-sm"},he={class:"whitespace-nowrap px-6 py-4 text-sm font-semibold"},$e={class:"whitespace-nowrap px-6 py-4 text-sm"},De={class:"whitespace-nowrap px-6 py-4 text-sm"},Ue={class:"whitespace-nowrap px-6 py-4 text-right"},Fe={class:"flex items-center justify-end gap-2"},Ee={class:"grid gap-4 py-4"},Ne={class:"grid gap-2"},Ae={key:0,class:"text-sm text-red-600"},Ie={class:"grid gap-2"},Te={key:0,class:"text-sm text-red-600"},Ke={class:"grid gap-4 sm:grid-cols-2"},Le={class:"grid gap-2"},Be={key:0,class:"text-sm text-red-600"},Oe={class:"grid gap-2"},Re={key:0,class:"text-sm text-red-600"},je={class:"grid gap-2"},ze={key:0,class:"text-sm text-red-600"},Ge={class:"grid gap-4 py-4"},qe={class:"grid gap-2"},He={key:0,class:"text-sm text-red-600"},Je={class:"grid gap-2"},Me={key:0,class:"text-sm text-red-600"},Qe={class:"grid gap-4 sm:grid-cols-2"},We={class:"grid gap-2"},Xe={key:0,class:"text-sm text-red-600"},Ye={class:"grid gap-2"},Ze={key:0,class:"text-sm text-red-600"},et={class:"grid gap-2"},tt={key:0,class:"text-sm text-red-600"},vt=ne({__name:"Index",props:{payments:{},students:{},fees:{}},setup(q){const D=q,g=D.payments||[],N=D.students||[],A=D.fees||[],P=E(!1),S=E(!1),U=E(null),H=[{title:"Dashboard",href:le().url},{title:"Fee Payments",href:oe.index.url}],i=T({student_id:"",fee_id:"",amount_paid:"",payment_date:new Date().toISOString().split("T")[0],status:"pending"}),n=T({student_id:"",fee_id:"",amount_paid:"",payment_date:"",status:""}),F=()=>{i.reset(),i.payment_date=new Date().toISOString().split("T")[0]},I=()=>{n.reset()},J=()=>{F(),P.value=!0},M=()=>{i.post("/fee-payments",{onSuccess:()=>{P.value=!1,F()}})},Q=m=>{const t=g.find(s=>s.id===m);t&&(U.value=t.id,n.student_id=t.student_id.toString(),n.fee_id=t.fee_id.toString(),n.amount_paid=t.amount_paid.toString(),n.payment_date=t.payment_date,n.status=t.status,S.value=!0)},W=()=>{U.value&&n.put(`/fee-payments/${U.value}`,{onSuccess:()=>{S.value=!1,I()}})},X=m=>{confirm("Are you sure you want to delete this payment?")&&ue.delete(`/fee-payments/${m}`)},C=m=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(m),Y=m=>m?new Date(m).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}):"Not paid",Z=m=>{const t={paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",partial:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",pending:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"};return t[m]||t.pending},ee=g.reduce((m,t)=>m+parseFloat(t.amount_paid||0),0),te=g.filter(m=>m.status==="paid").length,se=g.filter(m=>m.status==="pending").length;return(m,t)=>(u(),p(y,null,[d(e(ie),{title:"Fee Payments"}),d(re,{breadcrumbs:H},{default:a(()=>[o("div",me,[o("div",pe,[o("div",fe,[t[16]||(t[16]=o("div",{class:"text-sm font-medium text-muted-foreground"},"Total Payments",-1)),o("div",_e,r(e(g).length),1)]),o("div",xe,[t[17]||(t[17]=o("div",{class:"text-sm font-medium text-muted-foreground"},"Total Collected",-1)),o("div",ge,r(C(e(ee))),1)]),o("div",ye,[t[18]||(t[18]=o("div",{class:"text-sm font-medium text-muted-foreground"},"Paid / Pending",-1)),o("div",ve,r(e(te))+" / "+r(e(se)),1)])]),o("div",be,[o("div",ce,[o("div",{class:"mb-4 flex items-center justify-between"},[t[19]||(t[19]=o("h2",{class:"text-xl font-semibold"},"Fee Payments",-1)),o("button",{onClick:J,class:"rounded-lg bg-black px-4 py-2 text-sm font-medium text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200"}," + Record Payment ")]),o("div",ke,[o("table",we,[t[22]||(t[22]=o("thead",{class:"bg-gray-50 dark:bg-sidebar-accent"},[o("tr",null,[o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Student"),o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Grade"),o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Term"),o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Amount Paid"),o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Payment Date"),o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Status"),o("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Actions")])],-1)),o("tbody",Ve,[(u(!0),p(y,null,V(e(g),(s,de)=>(u(),p("tr",{key:s.id,class:K(["hover:bg-gray-50 dark:hover:bg-sidebar-accent",{"bg-muted/50":de%2===0}])},[o("td",Pe,r(s.student?.first_name)+" "+r(s.student?.last_name),1),o("td",Se,r(s.fee?.grade?.name||"N/A"),1),o("td",Ce,r(s.fee?.term||"N/A"),1),o("td",he,r(C(s.amount_paid)),1),o("td",$e,r(Y(s.payment_date)),1),o("td",De,[o("span",{class:K([Z(s.status),"rounded-full px-2 py-1 text-xs font-medium uppercase"])},r(s.status),3)]),o("td",Ue,[o("div",Fe,[d(e(v),{variant:"ghost",size:"sm",onClick:ae=>Q(s.id)},{default:a(()=>[...t[20]||(t[20]=[l(" Edit ",-1)])]),_:1},8,["onClick"]),d(e(v),{variant:"destructive",size:"sm",onClick:ae=>X(s.id)},{default:a(()=>[...t[21]||(t[21]=[l(" Delete ",-1)])]),_:1},8,["onClick"])])])],2))),128))])])])])])]),d(e(L),{open:P.value,"onUpdate:open":t[7]||(t[7]=s=>P.value=s)},{default:a(()=>[d(e(B),{class:"sm:max-w-2xl",onInteractOutside:t[5]||(t[5]=s=>s.preventDefault()),onEscapeKeyDown:t[6]||(t[6]=s=>s.preventDefault())},{default:a(()=>[d(e(O),null,{default:a(()=>[d(e(R),null,{default:a(()=>[...t[23]||(t[23]=[l("Record New Payment",-1)])]),_:1}),d(e(j),null,{default:a(()=>[...t[24]||(t[24]=[l(" Enter the payment details below to record a new fee payment. ",-1)])]),_:1})]),_:1}),o("div",Ee,[o("div",Ne,[d(e(x),{for:"student_id"},{default:a(()=>[...t[25]||(t[25]=[l("Student",-1)])]),_:1}),d(e(b),{modelValue:e(i).student_id,"onUpdate:modelValue":t[0]||(t[0]=s=>e(i).student_id=s)},{default:a(()=>[d(e(c),null,{default:a(()=>[d(e(k),{placeholder:"Select a student"})]),_:1}),d(e(w),null,{default:a(()=>[(u(!0),p(y,null,V(e(N),s=>(u(),h(e(_),{key:s.id,value:s.id.toString()},{default:a(()=>[l(r(s.first_name)+" "+r(s.last_name)+" - "+r(s.adm_no),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(i).errors.student_id?(u(),p("span",Ae,r(e(i).errors.student_id),1)):f("",!0)]),o("div",Ie,[d(e(x),{for:"fee_id"},{default:a(()=>[...t[26]||(t[26]=[l("Fee",-1)])]),_:1}),d(e(b),{modelValue:e(i).fee_id,"onUpdate:modelValue":t[1]||(t[1]=s=>e(i).fee_id=s)},{default:a(()=>[d(e(c),null,{default:a(()=>[d(e(k),{placeholder:"Select a fee"})]),_:1}),d(e(w),null,{default:a(()=>[(u(!0),p(y,null,V(e(A),s=>(u(),h(e(_),{key:s.id,value:s.id.toString()},{default:a(()=>[l(r(s.grade?.name)+" - "+r(s.term)+" ("+r(C(s.amount))+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(i).errors.fee_id?(u(),p("span",Te,r(e(i).errors.fee_id),1)):f("",!0)]),o("div",Ke,[o("div",Le,[d(e(x),{for:"amount_paid"},{default:a(()=>[...t[27]||(t[27]=[l("Amount Paid",-1)])]),_:1}),d(e($),{id:"amount_paid",modelValue:e(i).amount_paid,"onUpdate:modelValue":t[2]||(t[2]=s=>e(i).amount_paid=s),type:"number",step:"0.01",placeholder:"15000.00"},null,8,["modelValue"]),e(i).errors.amount_paid?(u(),p("span",Be,r(e(i).errors.amount_paid),1)):f("",!0)]),o("div",Oe,[d(e(x),{for:"payment_date"},{default:a(()=>[...t[28]||(t[28]=[l("Payment Date",-1)])]),_:1}),d(e($),{id:"payment_date",modelValue:e(i).payment_date,"onUpdate:modelValue":t[3]||(t[3]=s=>e(i).payment_date=s),type:"date"},null,8,["modelValue"]),e(i).errors.payment_date?(u(),p("span",Re,r(e(i).errors.payment_date),1)):f("",!0)])]),o("div",je,[d(e(x),{for:"status"},{default:a(()=>[...t[29]||(t[29]=[l("Status",-1)])]),_:1}),d(e(b),{modelValue:e(i).status,"onUpdate:modelValue":t[4]||(t[4]=s=>e(i).status=s)},{default:a(()=>[d(e(c),null,{default:a(()=>[d(e(k),{placeholder:"Select status"})]),_:1}),d(e(w),null,{default:a(()=>[d(e(_),{value:"pending"},{default:a(()=>[...t[30]||(t[30]=[l("Pending",-1)])]),_:1}),d(e(_),{value:"partial"},{default:a(()=>[...t[31]||(t[31]=[l("Partial",-1)])]),_:1}),d(e(_),{value:"paid"},{default:a(()=>[...t[32]||(t[32]=[l("Paid",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(i).errors.status?(u(),p("span",ze,r(e(i).errors.status),1)):f("",!0)])]),d(e(z),{class:"pt-4"},{default:a(()=>[d(e(G),{"as-child":""},{default:a(()=>[d(e(v),{variant:"outline",onClick:F},{default:a(()=>[...t[33]||(t[33]=[l(" Cancel ",-1)])]),_:1})]),_:1}),d(e(v),{onClick:M,disabled:e(i).processing},{default:a(()=>[l(r(e(i).processing?"Recording...":"Record Payment"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),d(e(L),{open:S.value,"onUpdate:open":t[15]||(t[15]=s=>S.value=s)},{default:a(()=>[d(e(B),{class:"sm:max-w-2xl",onInteractOutside:t[13]||(t[13]=s=>s.preventDefault()),onEscapeKeyDown:t[14]||(t[14]=s=>s.preventDefault())},{default:a(()=>[d(e(O),null,{default:a(()=>[d(e(R),null,{default:a(()=>[...t[34]||(t[34]=[l("Edit Payment",-1)])]),_:1}),d(e(j),null,{default:a(()=>[...t[35]||(t[35]=[l(" Update the payment details below. ",-1)])]),_:1})]),_:1}),o("div",Ge,[o("div",qe,[d(e(x),{for:"edit_student_id"},{default:a(()=>[...t[36]||(t[36]=[l("Student",-1)])]),_:1}),d(e(b),{modelValue:e(n).student_id,"onUpdate:modelValue":t[8]||(t[8]=s=>e(n).student_id=s)},{default:a(()=>[d(e(c),null,{default:a(()=>[d(e(k),{placeholder:"Select a student"})]),_:1}),d(e(w),null,{default:a(()=>[(u(!0),p(y,null,V(e(N),s=>(u(),h(e(_),{key:s.id,value:s.id.toString()},{default:a(()=>[l(r(s.first_name)+" "+r(s.last_name)+" - "+r(s.adm_no),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(n).errors.student_id?(u(),p("span",He,r(e(n).errors.student_id),1)):f("",!0)]),o("div",Je,[d(e(x),{for:"edit_fee_id"},{default:a(()=>[...t[37]||(t[37]=[l("Fee",-1)])]),_:1}),d(e(b),{modelValue:e(n).fee_id,"onUpdate:modelValue":t[9]||(t[9]=s=>e(n).fee_id=s)},{default:a(()=>[d(e(c),null,{default:a(()=>[d(e(k),{placeholder:"Select a fee"})]),_:1}),d(e(w),null,{default:a(()=>[(u(!0),p(y,null,V(e(A),s=>(u(),h(e(_),{key:s.id,value:s.id.toString()},{default:a(()=>[l(r(s.grade?.name)+" - "+r(s.term)+" ("+r(C(s.amount))+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(n).errors.fee_id?(u(),p("span",Me,r(e(n).errors.fee_id),1)):f("",!0)]),o("div",Qe,[o("div",We,[d(e(x),{for:"edit_amount_paid"},{default:a(()=>[...t[38]||(t[38]=[l("Amount Paid",-1)])]),_:1}),d(e($),{id:"edit_amount_paid",modelValue:e(n).amount_paid,"onUpdate:modelValue":t[10]||(t[10]=s=>e(n).amount_paid=s),type:"number",step:"0.01",placeholder:"15000.00"},null,8,["modelValue"]),e(n).errors.amount_paid?(u(),p("span",Xe,r(e(n).errors.amount_paid),1)):f("",!0)]),o("div",Ye,[d(e(x),{for:"edit_payment_date"},{default:a(()=>[...t[39]||(t[39]=[l("Payment Date",-1)])]),_:1}),d(e($),{id:"edit_payment_date",modelValue:e(n).payment_date,"onUpdate:modelValue":t[11]||(t[11]=s=>e(n).payment_date=s),type:"date"},null,8,["modelValue"]),e(n).errors.payment_date?(u(),p("span",Ze,r(e(n).errors.payment_date),1)):f("",!0)])]),o("div",et,[d(e(x),{for:"edit_status"},{default:a(()=>[...t[40]||(t[40]=[l("Status",-1)])]),_:1}),d(e(b),{modelValue:e(n).status,"onUpdate:modelValue":t[12]||(t[12]=s=>e(n).status=s)},{default:a(()=>[d(e(c),null,{default:a(()=>[d(e(k),{placeholder:"Select status"})]),_:1}),d(e(w),null,{default:a(()=>[d(e(_),{value:"pending"},{default:a(()=>[...t[41]||(t[41]=[l("Pending",-1)])]),_:1}),d(e(_),{value:"partial"},{default:a(()=>[...t[42]||(t[42]=[l("Partial",-1)])]),_:1}),d(e(_),{value:"paid"},{default:a(()=>[...t[43]||(t[43]=[l("Paid",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(n).errors.status?(u(),p("span",tt,r(e(n).errors.status),1)):f("",!0)])]),d(e(z),{class:"pt-4"},{default:a(()=>[d(e(G),{"as-child":""},{default:a(()=>[d(e(v),{variant:"outline",onClick:I},{default:a(()=>[...t[44]||(t[44]=[l(" Cancel ",-1)])]),_:1})]),_:1}),d(e(v),{onClick:W,disabled:e(n).processing},{default:a(()=>[l(r(e(n).processing?"Updating...":"Update Payment"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{vt as default};
