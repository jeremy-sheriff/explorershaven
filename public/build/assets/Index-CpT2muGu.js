import{d as le,q as M,v as _e,u as e,c as m,e as xe,s as ve,o as i,f as A,g as P,i as W,a as s,h as be,w as r,b as o,t as l,k as d,j as _,F as U,r as O,l as B,x as H}from"./app-n1Yk933b.js";import{U as J,S as ce,_ as ye}from"./AppLayout.vue_vue_type_script_setup_true_lang-CWpH5lZm.js";import{d as we}from"./index-C4J_hXM0.js";import{c as ke,_ as p}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-pKe0QKHw.js";import{_ as N,a as D,b as h,c as T,d as F}from"./DialogTitle.vue_vue_type_script_setup_true_lang-CcjtoLsF.js";import{_ as Y,a as L}from"./DialogFooter.vue_vue_type_script_setup_true_lang-n3L1K8bF.js";import{_ as Q,a as X,b as Z,c as ee,d as te}from"./SelectValue.vue_vue_type_script_setup_true_lang-BAVhEftO.js";import{C as S,_ as E,a as se,b as I}from"./index-CBIgW0G7.js";import{_ as re}from"./Input.vue_vue_type_script_setup_true_lang-t4PK_Bum.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-DqgjB8RL.js";import{u as Se}from"./index-BvILESd2.js";import{T as ae,G as oe}from"./trending-up-DE_mdSGN.js";import"./VisuallyHidden-C92m5U8f.js";import"./useForwardExpose-x_WGzJLT.js";import"./useForwardPropsEmits-C8stnXUc.js";import"./createLucideIcon-sRWBxzRP.js";import"./check-BQBGsFow.js";import"./useFormControl-Bg86UH2k.js";const de=le({__name:"Textarea",props:{class:{},defaultValue:{},modelValue:{}},emits:["update:modelValue"],setup(V,{emit:x}){const g=V,b=Se(g,"modelValue",x,{passive:!0,defaultValue:g.defaultValue});return(y,c)=>M((i(),m("textarea",{"onUpdate:modelValue":c[0]||(c[0]=w=>ve(b)?b.value=w:null),"data-slot":"textarea",class:xe(e(ke)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",g.class))},null,2)),[[_e,e(b)]])}}),Ve={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},Ce={class:"grid auto-rows-min gap-4 md:grid-cols-4"},Ge={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},$e={class:"flex items-center gap-2"},Ae={class:"text-2xl font-bold"},Pe={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},Ue={class:"flex items-center gap-2"},Ne={class:"text-2xl font-bold"},De={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},he={class:"flex items-center gap-2"},Te={class:"text-2xl font-bold"},Fe={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},Ye={class:"flex items-center gap-2"},Le={class:"text-2xl font-bold"},Ee={class:"flex flex-wrap gap-3"},Ie={class:"relative min-h-[50vh] flex-1 rounded-xl border border-sidebar-border/70 bg-white md:min-h-min dark:border-sidebar-border dark:bg-sidebar"},Oe={class:"p-6"},Be={class:"overflow-x-auto"},Me={class:"min-w-full divide-y divide-gray-200"},Ke={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-sidebar"},ze={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},je={class:"whitespace-nowrap px-6 py-4 text-sm"},Re={class:"whitespace-nowrap px-6 py-4 text-sm"},qe={key:0,class:"rounded-full bg-purple-100 px-2 py-1 text-xs font-medium text-purple-800 dark:bg-purple-900 dark:text-purple-200"},We={key:1,class:"rounded-full bg-green-100 px-2 py-1 text-xs font-medium text-green-800 dark:bg-green-900 dark:text-green-200"},He={class:"whitespace-nowrap px-6 py-4 text-right"},Je={key:0,class:"py-12 text-center"},Qe={class:"grid gap-4 py-4"},Xe={class:"grid gap-2"},Ze={key:0,class:"text-sm text-red-600"},et={class:"grid gap-2"},tt={key:0,class:"text-xs text-muted-foreground"},st={key:1,class:"text-sm text-red-600"},rt={class:"grid gap-2"},at={key:0,class:"text-sm text-red-600"},ot={class:"grid gap-4 py-4"},dt={class:"grid gap-2"},lt={class:"grid gap-4 py-4"},nt={class:"grid gap-2"},it={key:0,class:"text-sm text-red-600"},ut={class:"flex items-center space-x-2"},mt={key:0},pt={key:1,class:"font-medium"},ft={class:"grid gap-4 py-4"},gt={class:"grid gap-2"},_t={key:0,class:"text-sm text-red-600"},xt={class:"flex items-center space-x-2"},Yt=le({__name:"Index",props:{grades:{},currentYear:{},stats:{},maxGradeLevel:{},autoGraduateEnabled:{type:Boolean}},setup(V){const x=V,g=x.grades||[],C=x.currentYear||"2025",b=x.stats||{},y=A(!1),c=A(!1),w=A(!1),G=A(!1),ne=[{title:"Dashboard",href:we().url},{title:"Student Progression",href:"#"}],n=P({from_grade_id:"",to_grade_id:"",notes:""}),k=P({notes:""}),u=P({new_year:"",promote_students:!0}),f=P({max_grade_level:x.maxGradeLevel||12,auto_graduate_enabled:x.autoGraduateEnabled||!0}),K=()=>{n.reset()},z=()=>{k.reset()},j=()=>{u.reset(),u.new_year="",u.promote_students=!0},ie=()=>{f.max_grade_level=x.maxGradeLevel||12,f.auto_graduate_enabled=x.autoGraduateEnabled||!0},ue=()=>{n.post("/student-progression/promote-grade",{onSuccess:()=>{y.value=!1,K()}})},me=()=>{confirm("This will promote ALL active students to the next grade. Are you sure?")&&k.post("/student-progression/promote-all",{onSuccess:()=>{c.value=!1,z()}})},pe=()=>{confirm(`Start academic year ${u.new_year}? This will update all students.`)&&u.post("/student-progression/start-new-year",{onSuccess:()=>{w.value=!1,j()}})},fe=()=>{f.put("/student-progression/settings",{onSuccess:()=>{G.value=!1}})},ge=W(()=>{if(!n.from_grade_id)return g;const $=parseInt(n.from_grade_id);return g.filter(t=>t.id>$)}),R=()=>(parseInt(C)+1).toString(),q=W(()=>g.reduce(($,t)=>$+(t.students_count||0),0));return($,t)=>(i(),m(U,null,[s(e(be),{title:"Student Progression"}),s(ye,{breadcrumbs:ne},{default:r(()=>[o("div",Ve,[o("div",Ce,[o("div",Ge,[o("div",$e,[s(e(J),{class:"h-5 w-5 text-blue-600"}),t[24]||(t[24]=o("div",{class:"text-sm font-medium text-muted-foreground"},"Active Students",-1))]),o("div",Ae,l(q.value),1)]),o("div",Pe,[o("div",Ue,[s(e(ae),{class:"h-5 w-5 text-green-600"}),t[25]||(t[25]=o("div",{class:"text-sm font-medium text-muted-foreground"},"Total Promotions",-1))]),o("div",Ne,l(e(b).total_promotions||0),1)]),o("div",De,[o("div",he,[s(e(oe),{class:"h-5 w-5 text-purple-600"}),t[26]||(t[26]=o("div",{class:"text-sm font-medium text-muted-foreground"},"Graduated",-1))]),o("div",Te,l(e(b).total_graduated||0),1)]),o("div",Fe,[o("div",Ye,[s(e(S),{class:"h-5 w-5 text-orange-600"}),t[27]||(t[27]=o("div",{class:"text-sm font-medium text-muted-foreground"},"Repetitions",-1))]),o("div",Le,l(e(b).total_repetitions||0),1)])]),s(e(E),{class:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950"},{default:r(()=>[s(e(S),{class:"h-4 w-4"}),s(e(se),null,{default:r(()=>[d("Current Academic Year: "+l(e(C)),1)]),_:1}),s(e(I),null,{default:r(()=>[...t[28]||(t[28]=[d(" Manage student progressions and start new academic years from this page. ",-1)])]),_:1})]),_:1}),o("div",Ee,[s(e(p),{onClick:t[0]||(t[0]=a=>y.value=!0),class:"gap-2"},{default:r(()=>[s(e(ae),{class:"h-4 w-4"}),t[29]||(t[29]=d(" Promote by Grade ",-1))]),_:1}),s(e(p),{onClick:t[1]||(t[1]=a=>c.value=!0),variant:"default",class:"gap-2"},{default:r(()=>[s(e(J),{class:"h-4 w-4"}),t[30]||(t[30]=d(" Promote All Students ",-1))]),_:1}),s(e(p),{onClick:t[2]||(t[2]=a=>w.value=!0),variant:"outline",class:"gap-2"},{default:r(()=>[s(e(oe),{class:"h-4 w-4"}),t[31]||(t[31]=d(" Start New Academic Year ",-1))]),_:1}),s(e(p),{onClick:t[3]||(t[3]=a=>G.value=!0),variant:"outline",class:"gap-2"},{default:r(()=>[s(e(ce),{class:"h-4 w-4"}),t[32]||(t[32]=d(" Settings ",-1))]),_:1})]),o("div",Ie,[o("div",Oe,[t[36]||(t[36]=o("h2",{class:"mb-4 text-xl font-semibold"},"Grades Overview",-1)),o("div",Be,[o("table",Me,[t[34]||(t[34]=o("thead",{class:"bg-gray-50 dark:bg-sidebar-accent"},[o("tr",null,[o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Grade"),o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Active Students"),o("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Status"),o("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Actions")])],-1)),o("tbody",Ke,[(i(!0),m(U,null,O(e(g),a=>(i(),m("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-sidebar-accent"},[o("td",ze,l(a.name),1),o("td",je,l(a.students_count||0)+" students ",1),o("td",Re,[a.id>=V.maxGradeLevel?(i(),m("span",qe," Final Grade ")):(i(),m("span",We," Active "))]),o("td",He,[a.students_count>0?(i(),B(e(p),{key:0,variant:"ghost",size:"sm",onClick:vt=>{e(n).from_grade_id=a.id.toString(),y.value=!0}},{default:r(()=>[...t[33]||(t[33]=[d(" Promote Grade ",-1)])]),_:1},8,["onClick"])):_("",!0)])]))),128))])]),e(g).length===0?(i(),m("div",Je,[...t[35]||(t[35]=[o("p",{class:"text-muted-foreground"},"No grades found.",-1)])])):_("",!0)])])])]),s(e(N),{open:y.value,"onUpdate:open":t[9]||(t[9]=a=>y.value=a)},{default:r(()=>[s(e(D),{class:"sm:max-w-2xl",onInteractOutside:t[7]||(t[7]=a=>a.preventDefault()),onEscapeKeyDown:t[8]||(t[8]=a=>a.preventDefault())},{default:r(()=>[s(e(h),null,{default:r(()=>[s(e(T),null,{default:r(()=>[...t[37]||(t[37]=[d("Promote Students by Grade",-1)])]),_:1}),s(e(F),null,{default:r(()=>[...t[38]||(t[38]=[d(" Select a grade to promote all students to the next grade level. ",-1)])]),_:1})]),_:1}),o("div",Qe,[o("div",Xe,[s(e(v),{for:"from_grade_id"},{default:r(()=>[...t[39]||(t[39]=[d("From Grade",-1)])]),_:1}),s(e(Q),{modelValue:e(n).from_grade_id,"onUpdate:modelValue":t[4]||(t[4]=a=>e(n).from_grade_id=a)},{default:r(()=>[s(e(X),null,{default:r(()=>[s(e(Z),{placeholder:"Select grade to promote from"})]),_:1}),s(e(ee),null,{default:r(()=>[(i(!0),m(U,null,O(e(g),a=>(i(),B(e(te),{key:a.id,value:a.id.toString()},{default:r(()=>[d(l(a.name)+" ("+l(a.students_count||0)+" students) ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(n).errors.from_grade_id?(i(),m("span",Ze,l(e(n).errors.from_grade_id),1)):_("",!0)]),o("div",et,[s(e(v),{for:"to_grade_id"},{default:r(()=>[...t[40]||(t[40]=[d("To Grade",-1)])]),_:1}),s(e(Q),{modelValue:e(n).to_grade_id,"onUpdate:modelValue":t[5]||(t[5]=a=>e(n).to_grade_id=a),disabled:!e(n).from_grade_id},{default:r(()=>[s(e(X),null,{default:r(()=>[s(e(Z),{placeholder:"Select target grade"})]),_:1}),s(e(ee),null,{default:r(()=>[(i(!0),m(U,null,O(ge.value,a=>(i(),B(e(te),{key:a.id,value:a.id.toString()},{default:r(()=>[d(l(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"]),e(n).from_grade_id?_("",!0):(i(),m("span",tt," Select a grade first ")),e(n).errors.to_grade_id?(i(),m("span",st,l(e(n).errors.to_grade_id),1)):_("",!0)]),o("div",rt,[s(e(v),{for:"notes"},{default:r(()=>[...t[41]||(t[41]=[d("Notes (Optional)",-1)])]),_:1}),s(e(de),{id:"notes",modelValue:e(n).notes,"onUpdate:modelValue":t[6]||(t[6]=a=>e(n).notes=a),placeholder:"Add any notes about this promotion...",rows:"3"},null,8,["modelValue"]),e(n).errors.notes?(i(),m("span",at,l(e(n).errors.notes),1)):_("",!0)]),s(e(E),{class:"border-orange-200 bg-orange-50 dark:border-orange-800 dark:bg-orange-950"},{default:r(()=>[s(e(S),{class:"h-4 w-4"}),s(e(I),null,{default:r(()=>[...t[42]||(t[42]=[d(" This will promote all active students in the selected grade. ",-1)])]),_:1})]),_:1})]),s(e(Y),{class:"pt-4"},{default:r(()=>[s(e(L),{"as-child":""},{default:r(()=>[s(e(p),{variant:"outline",onClick:K},{default:r(()=>[...t[43]||(t[43]=[d(" Cancel ",-1)])]),_:1})]),_:1}),s(e(p),{onClick:ue,disabled:e(n).processing},{default:r(()=>[d(l(e(n).processing?"Promoting...":"Promote Grade"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(N),{open:c.value,"onUpdate:open":t[13]||(t[13]=a=>c.value=a)},{default:r(()=>[s(e(D),{class:"sm:max-w-2xl",onInteractOutside:t[11]||(t[11]=a=>a.preventDefault()),onEscapeKeyDown:t[12]||(t[12]=a=>a.preventDefault())},{default:r(()=>[s(e(h),null,{default:r(()=>[s(e(T),null,{default:r(()=>[...t[44]||(t[44]=[d("Promote All Students",-1)])]),_:1}),s(e(F),null,{default:r(()=>[...t[45]||(t[45]=[d(" This will promote ALL active students to their next grade level. ",-1)])]),_:1})]),_:1}),o("div",ot,[o("div",dt,[s(e(v),{for:"promote_all_notes"},{default:r(()=>[...t[46]||(t[46]=[d("Notes (Optional)",-1)])]),_:1}),s(e(de),{id:"promote_all_notes",modelValue:e(k).notes,"onUpdate:modelValue":t[10]||(t[10]=a=>e(k).notes=a),placeholder:"Add any notes about this bulk promotion...",rows:"3"},null,8,["modelValue"])]),s(e(E),{class:"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-950"},{default:r(()=>[s(e(S),{class:"h-4 w-4 text-red-600"}),s(e(se),{class:"text-red-800 dark:text-red-200"},{default:r(()=>[...t[47]||(t[47]=[d("Warning",-1)])]),_:1}),s(e(I),{class:"text-red-700 dark:text-red-300"},{default:r(()=>[d(" This action will promote "+l(q.value)+" students across all grades. Students at the maximum grade level will be graduated. This action cannot be easily undone. ",1)]),_:1})]),_:1})]),s(e(Y),{class:"pt-4"},{default:r(()=>[s(e(L),{"as-child":""},{default:r(()=>[s(e(p),{variant:"outline",onClick:z},{default:r(()=>[...t[48]||(t[48]=[d(" Cancel ",-1)])]),_:1})]),_:1}),s(e(p),{onClick:me,disabled:e(k).processing,variant:"destructive"},{default:r(()=>[d(l(e(k).processing?"Promoting...":"Confirm Promotion"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(N),{open:w.value,"onUpdate:open":t[18]||(t[18]=a=>w.value=a)},{default:r(()=>[s(e(D),{class:"sm:max-w-2xl",onInteractOutside:t[16]||(t[16]=a=>a.preventDefault()),onEscapeKeyDown:t[17]||(t[17]=a=>a.preventDefault())},{default:r(()=>[s(e(h),null,{default:r(()=>[s(e(T),null,{default:r(()=>[...t[49]||(t[49]=[d("Start New Academic Year",-1)])]),_:1}),s(e(F),null,{default:r(()=>[...t[50]||(t[50]=[d(" Begin a new academic year and optionally promote all students. ",-1)])]),_:1})]),_:1}),o("div",lt,[o("div",nt,[s(e(v),{for:"new_year"},{default:r(()=>[...t[51]||(t[51]=[d("New Academic Year",-1)])]),_:1}),s(e(re),{id:"new_year",modelValue:e(u).new_year,"onUpdate:modelValue":t[14]||(t[14]=a=>e(u).new_year=a),type:"text",placeholder:R()},null,8,["modelValue","placeholder"]),e(u).errors.new_year?(i(),m("span",it,l(e(u).errors.new_year),1)):_("",!0)]),o("div",ut,[M(o("input",{id:"promote_students","onUpdate:modelValue":t[15]||(t[15]=a=>e(u).promote_students=a),type:"checkbox",class:"h-4 w-4 rounded border-gray-300"},null,512),[[H,e(u).promote_students]]),s(e(v),{for:"promote_students",class:"cursor-pointer"},{default:r(()=>[...t[52]||(t[52]=[d(" Automatically promote all students to next grade ",-1)])]),_:1})]),s(e(E),{class:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950"},{default:r(()=>[s(e(S),{class:"h-4 w-4"}),s(e(I),null,{default:r(()=>[d(" Current year: "+l(e(C))+" â†’ New year: "+l(e(u).new_year||R())+" ",1),e(u).promote_students?(i(),m("br",mt)):_("",!0),e(u).promote_students?(i(),m("span",pt," All students will be promoted to the next grade level. ")):_("",!0)]),_:1})]),_:1})]),s(e(Y),{class:"pt-4"},{default:r(()=>[s(e(L),{"as-child":""},{default:r(()=>[s(e(p),{variant:"outline",onClick:j},{default:r(()=>[...t[53]||(t[53]=[d(" Cancel ",-1)])]),_:1})]),_:1}),s(e(p),{onClick:pe,disabled:e(u).processing||!e(u).new_year},{default:r(()=>[d(l(e(u).processing?"Starting...":"Start New Year"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),s(e(N),{open:G.value,"onUpdate:open":t[23]||(t[23]=a=>G.value=a)},{default:r(()=>[s(e(D),{class:"sm:max-w-2xl",onInteractOutside:t[21]||(t[21]=a=>a.preventDefault()),onEscapeKeyDown:t[22]||(t[22]=a=>a.preventDefault())},{default:r(()=>[s(e(h),null,{default:r(()=>[s(e(T),null,{default:r(()=>[...t[54]||(t[54]=[d("Progression Settings",-1)])]),_:1}),s(e(F),null,{default:r(()=>[...t[55]||(t[55]=[d(" Configure student progression and graduation settings. ",-1)])]),_:1})]),_:1}),o("div",ft,[o("div",gt,[s(e(v),{for:"max_grade_level"},{default:r(()=>[...t[56]||(t[56]=[d("Maximum Grade Level",-1)])]),_:1}),s(e(re),{id:"max_grade_level",modelValue:e(f).max_grade_level,"onUpdate:modelValue":t[19]||(t[19]=a=>e(f).max_grade_level=a),type:"number",min:"1",max:"20"},null,8,["modelValue"]),t[57]||(t[57]=o("span",{class:"text-xs text-muted-foreground"}," Students at this grade level will be graduated when promoted ",-1)),e(f).errors.max_grade_level?(i(),m("span",_t,l(e(f).errors.max_grade_level),1)):_("",!0)]),o("div",xt,[M(o("input",{id:"auto_graduate_enabled","onUpdate:modelValue":t[20]||(t[20]=a=>e(f).auto_graduate_enabled=a),type:"checkbox",class:"h-4 w-4 rounded border-gray-300"},null,512),[[H,e(f).auto_graduate_enabled]]),s(e(v),{for:"auto_graduate_enabled",class:"cursor-pointer"},{default:r(()=>[...t[58]||(t[58]=[d(" Automatically graduate students at maximum grade level ",-1)])]),_:1})])]),s(e(Y),{class:"pt-4"},{default:r(()=>[s(e(L),{"as-child":""},{default:r(()=>[s(e(p),{variant:"outline",onClick:ie},{default:r(()=>[...t[59]||(t[59]=[d(" Cancel ",-1)])]),_:1})]),_:1}),s(e(p),{onClick:fe,disabled:e(f).processing},{default:r(()=>[d(l(e(f).processing?"Saving...":"Save Settings"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{Yt as default};
