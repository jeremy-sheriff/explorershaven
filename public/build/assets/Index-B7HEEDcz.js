import{X as j,_ as ne}from"./AppLayout.vue_vue_type_script_setup_true_lang-DmLAfLna.js";import{d as ue}from"./index-Bhpqllgs.js";import{d as me,f as A,g as I,i as pe,c as m,a as d,u as e,h as fe,w as l,b as r,t as u,j as g,k as a,o,l as y,F as b,r as V,m as L}from"./app-dboXGuNV.js";import{_}from"./index-f0q_H6XX.js";import{_ as q,a as R,b as X,c as H,d as J}from"./DialogTitle.vue_vue_type_script_setup_true_lang-B4HMMy3N.js";import{_ as M,a as P}from"./DialogFooter.vue_vue_type_script_setup_true_lang-DY0fu5oK.js";import{_ as D,a as U,b as E,c as T,d as c}from"./SelectValue.vue_vue_type_script_setup_true_lang-rbRv9onB.js";import{_ as k}from"./Input.vue_vue_type_script_setup_true_lang-CQR-SVFb.js";import{_ as x}from"./Label.vue_vue_type_script_setup_true_lang-DwzsXbF0.js";import{F as ge}from"./filter-eD4YxXd3.js";import"./index-DR4uO0Az.js";import"./VisuallyHidden-Qeg6tdec.js";import"./useForwardExpose-DuKNPaFp.js";import"./useForwardPropsEmits-BGSqFsqn.js";import"./index-CMWG4mbA.js";import"./createLucideIcon-CVI3afpd.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C6eeodCg.js";import"./check-CBRHKuNN.js";import"./useFormControl-Cqq63ItI.js";const _e={class:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4"},xe={class:"grid auto-rows-min gap-4 md:grid-cols-3"},ve={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},ye={class:"text-2xl font-bold"},be={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},ce={class:"text-2xl font-bold"},ke={class:"relative overflow-hidden rounded-xl border border-sidebar-border/70 p-6 dark:border-sidebar-border"},we={class:"text-2xl font-bold"},Fe={class:"relative min-h-[100vh] flex-1 rounded-xl border border-sidebar-border/70 bg-white md:min-h-min dark:border-sidebar-border dark:bg-sidebar"},Ve={class:"p-6"},Ce={class:"mb-4 flex items-center justify-between"},$e={class:"flex gap-2"},he={key:0,class:"ml-1 rounded-full bg-primary px-2 py-0.5 text-xs text-primary-foreground"},Se={key:0,class:"mb-6 rounded-lg border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-sidebar-accent"},Ae={class:"mb-4 flex items-center justify-between"},De={class:"grid gap-4 md:grid-cols-2"},Ue={class:"grid gap-2"},Ee={class:"grid gap-2"},Te={class:"mt-4 flex justify-end gap-2"},Ne={key:1,class:"mb-4 flex flex-wrap gap-2"},Ge={key:0,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},Ke={key:1,class:"inline-flex items-center gap-1 rounded-full bg-primary/10 px-3 py-1 text-xs"},je={class:"overflow-x-auto"},Ie={class:"min-w-full divide-y divide-gray-200"},Le={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-sidebar"},Be={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},ze={class:"whitespace-nowrap px-6 py-4 text-sm font-medium"},Oe={class:"whitespace-nowrap px-6 py-4 text-sm"},qe={class:"whitespace-nowrap px-6 py-4 text-sm font-semibold"},Re={class:"whitespace-nowrap px-6 py-4 text-sm"},Xe={class:"whitespace-nowrap px-6 py-4 text-right"},He={class:"flex items-center justify-end gap-2"},Je={key:0,class:"py-12 text-center"},Me={class:"grid gap-4 py-4"},Pe={class:"grid gap-2"},Qe={key:0,class:"text-sm text-red-600"},We={class:"grid gap-2"},Ye={key:0,class:"text-sm text-red-600"},Ze={class:"grid gap-4 sm:grid-cols-2"},et={class:"grid gap-2"},tt={key:0,class:"text-sm text-red-600"},st={class:"grid gap-2"},dt={key:0,class:"text-sm text-red-600"},rt={class:"grid gap-4 py-4"},lt={class:"grid gap-2"},at={key:0,class:"text-sm text-red-600"},ot={class:"grid gap-2"},it={key:0,class:"text-sm text-red-600"},nt={class:"grid gap-4 sm:grid-cols-2"},ut={class:"grid gap-2"},mt={key:0,class:"text-sm text-red-600"},pt={class:"grid gap-2"},ft={key:0,class:"text-sm text-red-600"},Tt=me({__name:"Index",props:{fees:{},grades:{},terms:{},filters:{}},setup(Q){const w=Q,v=w.fees||[],C=w.grades||[],W=w.terms||[],F=A(!1),$=A(!1),h=A(!1),N=A(null),i=I({grade:w.filters?.grade||"all",term:w.filters?.term||"all"}),Y=[{title:"Dashboard",href:ue().url},{title:"Fees",href:"#"}],p=I({grade_id:"",amount:"",term:"",due_date:""}),n=I({grade_id:"",amount:"",term:"",due_date:""}),G=()=>{p.reset()},B=()=>{n.reset()},Z=()=>{G(),$.value=!0},ee=()=>{p.post("/fees",{onSuccess:()=>{$.value=!1,G()}})},te=f=>{const t=v.find(s=>s.id===f);t&&(N.value=t.id,n.grade_id=t.grade_id.toString(),n.amount=t.amount.toString(),n.term=t.term,n.due_date=t.due_date,h.value=!0)},se=()=>{N.value&&n.put(`/fees/${N.value}`,{onSuccess:()=>{h.value=!1,B()}})},de=f=>{confirm("Are you sure you want to delete this fee?")&&L.delete(`/fees/${f}`)},z=f=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES"}).format(f),re=f=>new Date(f).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}),K=()=>{const f={};i.grade&&i.grade!=="all"&&(f.grade=i.grade),i.term&&i.term!=="all"&&(f.term=i.term),L.get("/fees",f,{preserveState:!1,preserveScroll:!1,only:["fees","filters"]})},O=()=>{i.grade="all",i.term="all",L.get("/fees",{},{preserveState:!1,preserveScroll:!1})},S=pe(()=>!!(i.grade&&i.grade!=="all"||i.term&&i.term!=="all")),le=v.reduce((f,t)=>f+parseFloat(t.amount||0),0),ae=[...new Set(v.map(f=>f.term))].length;return[...new Set(v.map(f=>f.grade_id))].length,(f,t)=>(o(),m(b,null,[d(e(fe),{title:"Fees"}),d(ne,{breadcrumbs:Y},{default:l(()=>[r("div",_e,[r("div",xe,[r("div",ve,[t[20]||(t[20]=r("div",{class:"text-sm font-medium text-muted-foreground"},"Total Fee Records",-1)),r("div",ye,u(e(v).length),1)]),r("div",be,[t[21]||(t[21]=r("div",{class:"text-sm font-medium text-muted-foreground"},"Total Amount",-1)),r("div",ce,u(z(e(le))),1)]),r("div",ke,[t[22]||(t[22]=r("div",{class:"text-sm font-medium text-muted-foreground"},"Active Terms",-1)),r("div",we,u(e(ae)),1)])]),r("div",Fe,[r("div",Ve,[r("div",Ce,[t[24]||(t[24]=r("h2",{class:"text-xl font-semibold"},"Fee Structure",-1)),r("div",$e,[d(e(_),{variant:"outline",onClick:t[0]||(t[0]=s=>F.value=!F.value),class:"gap-2"},{default:l(()=>[d(e(ge),{class:"h-4 w-4"}),t[23]||(t[23]=a(" Filters ",-1)),S.value?(o(),m("span",he," Active ")):g("",!0)]),_:1}),r("button",{onClick:Z,class:"rounded-lg bg-black px-4 py-2 text-sm font-medium text-white hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200"}," + Add Fee ")])]),F.value?(o(),m("div",Se,[r("div",Ae,[t[26]||(t[26]=r("h3",{class:"font-semibold"},"Filter Fees",-1)),S.value?(o(),y(e(_),{key:0,variant:"ghost",size:"sm",onClick:O,class:"gap-2 text-red-600 hover:text-red-700"},{default:l(()=>[d(e(j),{class:"h-4 w-4"}),t[25]||(t[25]=a(" Clear All ",-1))]),_:1})):g("",!0)]),r("div",De,[r("div",Ue,[d(e(x),null,{default:l(()=>[...t[27]||(t[27]=[a("Grade",-1)])]),_:1}),d(e(D),{modelValue:e(i).grade,"onUpdate:modelValue":t[1]||(t[1]=s=>e(i).grade=s)},{default:l(()=>[d(e(U),null,{default:l(()=>[d(e(E),{placeholder:"All Grades"})]),_:1}),d(e(T),null,{default:l(()=>[d(e(c),{value:"all"},{default:l(()=>[...t[28]||(t[28]=[a("All Grades",-1)])]),_:1}),(o(!0),m(b,null,V(e(C),s=>(o(),y(e(c),{key:s.id,value:s.id.toString()},{default:l(()=>[a(u(s.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),r("div",Ee,[d(e(x),null,{default:l(()=>[...t[29]||(t[29]=[a("Term",-1)])]),_:1}),d(e(D),{modelValue:e(i).term,"onUpdate:modelValue":t[2]||(t[2]=s=>e(i).term=s)},{default:l(()=>[d(e(U),null,{default:l(()=>[d(e(E),{placeholder:"All Terms"})]),_:1}),d(e(T),null,{default:l(()=>[d(e(c),{value:"all"},{default:l(()=>[...t[30]||(t[30]=[a("All Terms",-1)])]),_:1}),(o(!0),m(b,null,V(e(W),s=>(o(),y(e(c),{key:s,value:s},{default:l(()=>[a(u(s),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])]),r("div",Te,[d(e(_),{variant:"outline",onClick:t[3]||(t[3]=s=>F.value=!1)},{default:l(()=>[...t[31]||(t[31]=[a(" Close ",-1)])]),_:1}),d(e(_),{onClick:K,disabled:e(i).processing},{default:l(()=>[...t[32]||(t[32]=[a(" Apply Filters ",-1)])]),_:1},8,["disabled"])])])):g("",!0),S.value&&!F.value?(o(),m("div",Ne,[t[33]||(t[33]=r("span",{class:"text-sm text-muted-foreground"},"Active filters:",-1)),e(i).grade&&e(i).grade!=="all"?(o(),m("span",Ge,[a(" Grade: "+u(e(C).find(s=>s.id.toString()===e(i).grade)?.name)+" ",1),r("button",{onClick:t[4]||(t[4]=s=>{e(i).grade="all",K()}),class:"hover:text-red-600"},[d(e(j),{class:"h-3 w-3"})])])):g("",!0),e(i).term&&e(i).term!=="all"?(o(),m("span",Ke,[a(" Term: "+u(e(i).term)+" ",1),r("button",{onClick:t[5]||(t[5]=s=>{e(i).term="all",K()}),class:"hover:text-red-600"},[d(e(j),{class:"h-3 w-3"})])])):g("",!0)])):g("",!0),r("div",je,[r("table",Ie,[t[36]||(t[36]=r("thead",{class:"bg-gray-50 dark:bg-sidebar-accent"},[r("tr",null,[r("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"#"),r("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Grade"),r("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Term"),r("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Amount"),r("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Due Date"),r("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase text-gray-500 dark:text-gray-400"},"Actions")])],-1)),r("tbody",Le,[(o(!0),m(b,null,V(e(v),(s,oe)=>(o(),m("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-sidebar-accent"},[r("td",Be,u(oe+1),1),r("td",ze,u(s.grade?.name||"N/A"),1),r("td",Oe,u(s.term),1),r("td",qe,u(z(s.amount)),1),r("td",Re,u(re(s.due_date)),1),r("td",Xe,[r("div",He,[d(e(_),{variant:"ghost",size:"sm",onClick:ie=>te(s.id)},{default:l(()=>[...t[34]||(t[34]=[a(" Edit ",-1)])]),_:1},8,["onClick"]),d(e(_),{variant:"destructive",size:"sm",onClick:ie=>de(s.id)},{default:l(()=>[...t[35]||(t[35]=[a(" Delete ",-1)])]),_:1},8,["onClick"])])])]))),128))])]),e(v).length===0?(o(),m("div",Je,[t[38]||(t[38]=r("p",{class:"text-muted-foreground"},"No fees found matching your filters.",-1)),S.value?(o(),y(e(_),{key:0,variant:"outline",class:"mt-4",onClick:O},{default:l(()=>[...t[37]||(t[37]=[a(" Clear Filters ",-1)])]),_:1})):g("",!0)])):g("",!0)])])])]),d(e(q),{open:$.value,"onUpdate:open":t[12]||(t[12]=s=>$.value=s)},{default:l(()=>[d(e(R),{class:"sm:max-w-2xl",onInteractOutside:t[10]||(t[10]=s=>s.preventDefault()),onEscapeKeyDown:t[11]||(t[11]=s=>s.preventDefault())},{default:l(()=>[d(e(X),null,{default:l(()=>[d(e(H),null,{default:l(()=>[...t[39]||(t[39]=[a("Add New Fee",-1)])]),_:1}),d(e(J),null,{default:l(()=>[...t[40]||(t[40]=[a(" Enter the fee details below. ",-1)])]),_:1})]),_:1}),r("div",Me,[r("div",Pe,[d(e(x),{for:"grade_id"},{default:l(()=>[...t[41]||(t[41]=[a("Grade",-1)])]),_:1}),d(e(D),{modelValue:e(p).grade_id,"onUpdate:modelValue":t[6]||(t[6]=s=>e(p).grade_id=s)},{default:l(()=>[d(e(U),null,{default:l(()=>[d(e(E),{placeholder:"Select a grade"})]),_:1}),d(e(T),null,{default:l(()=>[(o(!0),m(b,null,V(e(C),s=>(o(),y(e(c),{key:s.id,value:s.id.toString()},{default:l(()=>[a(u(s.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(p).errors.grade_id?(o(),m("span",Qe,u(e(p).errors.grade_id),1)):g("",!0)]),r("div",We,[d(e(x),{for:"term"},{default:l(()=>[...t[42]||(t[42]=[a("Term",-1)])]),_:1}),d(e(k),{id:"term",modelValue:e(p).term,"onUpdate:modelValue":t[7]||(t[7]=s=>e(p).term=s),type:"text",placeholder:"e.g., Term 1 2025"},null,8,["modelValue"]),e(p).errors.term?(o(),m("span",Ye,u(e(p).errors.term),1)):g("",!0)]),r("div",Ze,[r("div",et,[d(e(x),{for:"amount"},{default:l(()=>[...t[43]||(t[43]=[a("Amount (KES)",-1)])]),_:1}),d(e(k),{id:"amount",modelValue:e(p).amount,"onUpdate:modelValue":t[8]||(t[8]=s=>e(p).amount=s),type:"number",step:"0.01",placeholder:"15000.00"},null,8,["modelValue"]),e(p).errors.amount?(o(),m("span",tt,u(e(p).errors.amount),1)):g("",!0)]),r("div",st,[d(e(x),{for:"due_date"},{default:l(()=>[...t[44]||(t[44]=[a("Due Date",-1)])]),_:1}),d(e(k),{id:"due_date",modelValue:e(p).due_date,"onUpdate:modelValue":t[9]||(t[9]=s=>e(p).due_date=s),type:"date"},null,8,["modelValue"]),e(p).errors.due_date?(o(),m("span",dt,u(e(p).errors.due_date),1)):g("",!0)])])]),d(e(M),{class:"pt-4"},{default:l(()=>[d(e(P),{"as-child":""},{default:l(()=>[d(e(_),{variant:"outline",onClick:G},{default:l(()=>[...t[45]||(t[45]=[a(" Cancel ",-1)])]),_:1})]),_:1}),d(e(_),{onClick:ee,disabled:e(p).processing},{default:l(()=>[a(u(e(p).processing?"Creating...":"Create Fee"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),d(e(q),{open:h.value,"onUpdate:open":t[19]||(t[19]=s=>h.value=s)},{default:l(()=>[d(e(R),{class:"sm:max-w-2xl",onInteractOutside:t[17]||(t[17]=s=>s.preventDefault()),onEscapeKeyDown:t[18]||(t[18]=s=>s.preventDefault())},{default:l(()=>[d(e(X),null,{default:l(()=>[d(e(H),null,{default:l(()=>[...t[46]||(t[46]=[a("Edit Fee",-1)])]),_:1}),d(e(J),null,{default:l(()=>[...t[47]||(t[47]=[a(" Update the fee details below. ",-1)])]),_:1})]),_:1}),r("div",rt,[r("div",lt,[d(e(x),{for:"edit_grade_id"},{default:l(()=>[...t[48]||(t[48]=[a("Grade",-1)])]),_:1}),d(e(D),{modelValue:e(n).grade_id,"onUpdate:modelValue":t[13]||(t[13]=s=>e(n).grade_id=s)},{default:l(()=>[d(e(U),null,{default:l(()=>[d(e(E),{placeholder:"Select a grade"})]),_:1}),d(e(T),null,{default:l(()=>[(o(!0),m(b,null,V(e(C),s=>(o(),y(e(c),{key:s.id,value:s.id.toString()},{default:l(()=>[a(u(s.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(n).errors.grade_id?(o(),m("span",at,u(e(n).errors.grade_id),1)):g("",!0)]),r("div",ot,[d(e(x),{for:"edit_term"},{default:l(()=>[...t[49]||(t[49]=[a("Term",-1)])]),_:1}),d(e(k),{id:"edit_term",modelValue:e(n).term,"onUpdate:modelValue":t[14]||(t[14]=s=>e(n).term=s),type:"text",placeholder:"e.g., Term 1 2025"},null,8,["modelValue"]),e(n).errors.term?(o(),m("span",it,u(e(n).errors.term),1)):g("",!0)]),r("div",nt,[r("div",ut,[d(e(x),{for:"edit_amount"},{default:l(()=>[...t[50]||(t[50]=[a("Amount (KES)",-1)])]),_:1}),d(e(k),{id:"edit_amount",modelValue:e(n).amount,"onUpdate:modelValue":t[15]||(t[15]=s=>e(n).amount=s),type:"number",step:"0.01",placeholder:"15000.00"},null,8,["modelValue"]),e(n).errors.amount?(o(),m("span",mt,u(e(n).errors.amount),1)):g("",!0)]),r("div",pt,[d(e(x),{for:"edit_due_date"},{default:l(()=>[...t[51]||(t[51]=[a("Due Date",-1)])]),_:1}),d(e(k),{id:"edit_due_date",modelValue:e(n).due_date,"onUpdate:modelValue":t[16]||(t[16]=s=>e(n).due_date=s),type:"date"},null,8,["modelValue"]),e(n).errors.due_date?(o(),m("span",ft,u(e(n).errors.due_date),1)):g("",!0)])])]),d(e(M),{class:"pt-4"},{default:l(()=>[d(e(P),{"as-child":""},{default:l(()=>[d(e(_),{variant:"outline",onClick:B},{default:l(()=>[...t[52]||(t[52]=[a(" Cancel ",-1)])]),_:1})]),_:1}),d(e(_),{onClick:se,disabled:e(n).processing},{default:l(()=>[a(u(e(n).processing?"Updating...":"Update Fee"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64))}});export{Tt as default};
